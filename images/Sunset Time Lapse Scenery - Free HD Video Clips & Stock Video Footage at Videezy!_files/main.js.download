(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;})();var ProperMediaVideo=ProperMediaVideo||{};ProperMediaVideo.utils=(function(win,document){var readyList=[];var readyFired=false;var readyEventHandlersInstalled=false;function ready(){if(!readyFired){readyFired=true;for(var i=0;i<readyList.length;i++){readyList[i].fn.call(win,readyList[i].ctx);}
readyList=[];}}
function readyStateChange(){if(document.readyState==="complete"){ready();}}
var docReady=function(callback,context){if(readyFired){setTimeout(function(){callback(context);},1);return;}else{readyList.push({fn:callback,ctx:context});}
if(document.readyState==="complete"){setTimeout(ready,1);}else if(!readyEventHandlersInstalled){if(document.addEventListener){document.addEventListener("DOMContentLoaded",ready,false);win.addEventListener("load",ready,false);}else{document.attachEvent("onreadystatechange",readyStateChange);win.attachEvent("onload",ready);}
readyEventHandlersInstalled=true;}}
function mergeObject(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(source.hasOwnProperty(key)){target[key]=source[key];}}}
return target;}
var jquery_utils={obj:{},sel:function(val){if(typeof val==="function"){docReady(val);}
else if(typeof val==="object")this.obj=val;else this.obj=document.querySelectorAll(val)[0];return this;},ready:function(func){docReady(func);return this;},remove:function(){if(typeof this.obj==='undefined')return false;this.obj.parentNode.removeChild(this.obj);return this;},hide:function(){if(typeof this.obj==='undefined')return false;this.obj.style.display='none';return this;},show:function(){if(typeof this.obj==='undefined')return false;this.obj.style.display='';return this;},addClass:function(className){if(typeof this.obj==='undefined')return false;var list=className.split(" ");for(var i=0;i<list.length;i++){if(this.obj.classList)this.obj.classList.add(list[i]);else this.obj.className+=' '+list[i];}
return this;},removeClass:function(className){if(typeof this.obj==='undefined')return false;if(this.obj.classList)this.obj.classList.remove(className);else{var newClassName="";var classes=this.className.split(" ");for(var i=0;i<classes.length;i++){if(classes[i]!==remove)newClassName+=classes[i]+" ";}
this.obj.className=newClassName;}
return this;},hasClass:function(className){if(typeof this.obj==='undefined')return false;if(this.obj.classList){return(this.obj.classList.contains(className));}else{var regex=new RegExp('(?:^|\\s)'+className+'(?!\\S)');return(this.obj.className.match(regex)!==null)?true:false;}
return this;},removeStyle:function(){if(typeof this.obj==='undefined')return false;this.obj.style='';return this;},attr:function(key,val){if(typeof this.obj==='undefined')return false;if(typeof val==='undefined'){if(typeof this.obj.getAttribute==='undefined')return null;else return this.obj.getAttribute(key);}
else{if(typeof this.obj.setAttribute==='undefined')return false;else{this.obj.setAttribute(key,val);return this;}}},after:function(htmlString){if(typeof this.obj==='undefined')return false;this.obj.insertAdjacentHTML('afterend',htmlString);return this;},before:function(htmlString){if(typeof this.obj==='undefined')return false;this.obj.insertAdjacentHTML('beforebegin',htmlString);return this;},append:function(newObj){if(typeof this.obj==='undefined')return false;if(typeof newObj==="string"){this.obj.innerHTML=this.obj.innerHTML+newObj;}
else this.obj.appendChild(newObj);return this;},html:function(htmlString){if(typeof this.obj==='undefined')return false;if(typeof htmlString!=='undefined'){this.obj.innerHTML=htmlString;return this;}else{return this.obj.innerHTML;}},parent:function(){if(typeof this.obj==='undefined')return false;this.obj=this.obj.parentNode;return this;},closest:function(className){if(typeof this.obj==='undefined'||!className)return false;while((this.obj=this.obj.parentNode)){if(typeof this.obj.classList!=='undefined'&&this.obj.classList.contains(className)){return this;}}
return false;},getChildNodes:function(){if(typeof this.obj==='undefined')return false;return this.obj.children;},val:function(text){if(typeof this.obj==='undefined')return false;if(typeof text==='undefined')return this.obj.value;else{this.obj.value=text;return this;}},on:function(type,func){if(typeof this.obj==='undefined')return false;if(type=="click"){this.obj.onclick=func;}
else if(type=="mouseover"||type=="mouseenter"){this.obj.addEventListener("mouseover",func,false);}
else if(type=="mouseout"||type=="mouseleave"){this.obj.addEventListener("mouseout",func,false);}
else{this.obj.addEventListener(type,func);}
return this;},contents:function(){if(typeof this.obj==='undefined')return false;this.obj=this.obj.contentDocument?this.obj.contentDocument:this.obj.contentWindow.document;return this;},contentWin:function(){if(typeof this.obj==='undefined')return false;if(this.obj.contentWindow)this.obj=this.obj.contentWindow;else if(this.obj.contentDocument)this.obj=this.obj.contentDocument.defaultView;return this;},find:function(val){if(typeof this.obj==='undefined')return false;this.obj=this.obj.querySelectorAll(val)[0];return this;},width:function(){return document.documentElement.clientWidth;},height:function(){return document.documentElement.clientHeight;},prev:function(){if(typeof this.obj==='undefined')return false;this.obj=this.obj.previousElementSibling;return this;},prop:function(type,val){if(typeof this.obj==='undefined')return false;this.obj.checked=val;return this;}};var jquery=function(val){return jquery_utils.sel(val);}
var req_id=0;jquery.ajax=function(parms){var url=parms.url;var callback=parms.success;var errFunc=parms.error;if(!errFunc)errFunc=function(){};var cache=parms.cache;var data=parms.data;var headers=parms.headers||{};var method=parms.method;if(!method)method="GET";var special=parms.special;var requestType=parms.requestType;var timeout=parms.timeout;if(timeout<0||!timeout)timeout=4000;if(requestType=="jsonp"){req_id++;if(callback){var separator="&";if(special&&special=="aol")separator=";";var mycallback='proper_'+guid()+"_"+req_id;window[mycallback]=function(e){callback(e);};var cname="callback";var callback_scope='window.';if(special&&(special=="rtk"||special=="mantis"||special=="gumgum"))cname="jsonp";else if(special&&special=="index")cname="fn";else if(special&&special=="sonobi"){cname="cv";callback_scope='';}
url+=separator+cname+'='+callback_scope+mycallback;}
var script=document.createElement('script');if(special=='pubmatic'){url+="&rid="+mycallback;script.onload=function(){callback(window["pubMaticBid_"+mycallback]);}}
script.async=true;script.src=url;document.getElementsByTagName('head')[0].appendChild(script);return true;}
if(data&&typeof(data)==='object'){var y='',e=encodeURIComponent;for(x in data){y+='&'+e(x)+'='+e(data[x]);}
data=y.slice(1)+(!cache?'&_t='+new Date:'');}
try{var xhr=null;if(window.ActiveXObject){xhr=new ActiveXObject('Microsoft.XMLHTTP');}
else if(window.XMLHttpRequest){xhr=new XMLHttpRequest();}
xhr.open(method,url,1);if(requestType=="cors"){xhr.withCredentials=true;}else if(requestType=="fetch"){xhr.withCredentials=false;}
xhr.timeout=timeout;xhr.onload=function(){if(xhr.status==200)callback(xhr.responseText,xhr);else{errFunc();}}
xhr.onerror=function(){errFunc();}
for(var headerKey in headers){xhr.setRequestHeader(headerKey,headers[headerKey]);}
xhr.send(data)}catch(e){errFunc();}}
function guid(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1,5);}
return s4()+s4()+'_'+s4()+s4();}
function b64EncodeUnicode(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function toSolidBytes(match,p1){return String.fromCharCode('0x'+p1);}));}
function b64DecodeUnicode(str){return decodeURIComponent(atob(str).split('').map(function(c){return '%'+('00'+c.charCodeAt(0).toString(16)).slice(-2);}).join(''));}
function isBase64(str){try{return b64EncodeUnicode(b64DecodeUnicode(str))==str;}catch(err){return false;}}
function safeJsonParse(json){try{return JSON.parse(json);}catch(e){console.error(e);}
return null;}
function deepAccess(obj,path){if(!obj){return;}
path=String(path).split('.');for(var i=0;i<path.length;i++){obj=obj[path[i]];if(typeof obj==='undefined'){return;}}
return obj;}
function getDNT(){return navigator.doNotTrack==='1'||window.doNotTrack==='1'||navigator.msDoNoTrack==='1'||navigator.doNotTrack==='yes';}
return{b64EncodeUnicode:b64EncodeUnicode,b64DecodeUnicode:b64DecodeUnicode,safeJsonParse:safeJsonParse,mergeObject:mergeObject,deepAccess:deepAccess,isBase64:isBase64,jquery:jquery,getDNT:getDNT,guid:guid};})(window,document);var propervideotag=propervideotag||[];if(!ProperMediaVideo.ad_project){ProperMediaVideo.ad_project=(function(win,document){var utils=ProperMediaVideo.utils;var $=utils.jquery;var applications=[];var displays_called=[];var global_ops={site_url:"https://propervideo.io",ad_count:0}
var style=document.createElement('style');style.type='text/css';var css=":root {--small_player_bottom: 0px;--proper-video-accent-color: #55CEFF; }.propervideo-white {color: white; }#propervideo-super_outer_container {font-family: \"HelveticaNeue-Light\", \"Helvetica Neue Light\", \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;font-weight: 300;display: flex;align-items: center;justify-content: center;flex-direction: column;width: 100%;max-width: 640px;max-height: 360px;margin: auto;position: relative;transition: max-height 0.5s ease-in-out;min-width: 300px;font-size: initial; }#propervideo-main_container {width: 100%;height: 100%;position: absolute;top: 0; }#outer_propervideo-back_image {padding-top: 56.3%;height: 0;width: 100%;overflow: hidden;position: relative;transition: padding-top 0.5s ease-in-out; }#propervideo-video_container {position: relative;background-color: #000;border-radius: 5px;max-width: 640px;width: 100%;max-height: 360px;height: 100%;margin-left: auto;margin-right: auto;transition: opacity 0.4s ease 0s; }#propervideo-video_container div.propervideo-white {position: absolute;top: 19px;left: 25px;border-radius: 3px;font-weight: bold;font-size: 18px;user-select: none;width: 60%;margin: auto;text-align: left;line-height: 1.5; }#propervideo-overlay-title {pointer-events: none;background: var(--proper-video-accent-color);padding: 5px 0px;box-shadow: -10px 0 0 0 var(--proper-video-accent-color), 10px 0 0 0 var(--proper-video-accent-color); }#propervideo-play-pause-button-image {width: 100%;height: 100%;display: flex;justify-content: center;align-items: center; }#propervideo-video_container.propervideo-bottom_player {cursor: pointer;height: 169px;max-width: 300px;width: 100%;bottom: var(--small_player_bottom);position: fixed !important;box-shadow: rgba(0, 0, 0, 0.6) 0 2px 7px;background-size: 100%;z-index: 99999999;transition: left 400ms ease-in-out,right 400ms ease-in-out, opacity 0.4s ease-in-out !important;-webkit-transition: left 400ms ease-in-out,right 400ms ease-in-out, opacity 0.4s ease-in-out !important; }#propervideo-video_container.propervideo-bottom_player .pv_overlay_play_button,#propervideo-video_container.propervideo-bottom_player .pv_overlay_pause_button {width: 35px !important;height: 35px !important; }#propervideo-video_container.propervideo-bottom_player div.propervideo-white {font-size: 10px !important;line-height: 1.5 !important;top: 10px !important;left: 15px !important; }#propervideo-video_container.propervideo-bottom_player #propervideo-video_quality,#propervideo-video_container.propervideo-bottom_player #propervideo-replay_button,#propervideo-video_container.propervideo-bottom_player #propervideo-quality-box {display: none; }#propervideo-video_container.propervideo-bottom_player #propervideo-progress_bar {border-radius: 0px; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls {height: 30px; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls:before {height: 31px;background: rgba(0, 0, 0, 0.7); }#propervideo-video_container.propervideo-bottom_player #propervideo-controls .top-progress-bar {width: 100%;left: 0; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls .propervideo-bottom-controls .propervideo-left-group #propervideo-play_button {margin: 0 10px; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls .propervideo-bottom-controls #propervideo-time {font-size: 12px; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls .propervideo-bottom-controls #propervideo-right-group {padding-right: 20px; }#propervideo-video_container.propervideo-bottom_player #propervideo-controls button {margin: 0 !important; }#propervideo-video_container.propervideo-bottom_player #propervideo-volume-group {right: 10px;bottom: 4px; }#propervideo-video_container.propervideo-bottom_player #clickthrough_button {bottom: -19px; }#propervideo-video_container.propervideo-bottom_player #clickthrough_url_button {font-size: 14px; }#clickthrough_button {position: absolute;z-index: 10;bottom: -13px;right: 0;left: 0;margin: auto;text-align: center;width: fit-content; }#clickthrough_url_button {background: var(--proper-video-accent-color);color: white;font-weight: bold;padding: 4px 5px;border-radius: 0;text-decoration: none;display: inline; }.propervideo-cancel_float {position: absolute;color: #afafaf;right: 0px;top: -24px;cursor: pointer;z-index: 0;box-sizing: initial;opacity: 0;-webkit-transition: opacity 400ms ease-in-out;transition: opacity 400ms ease-in-out; }.propervideo-cancel_float svg {width: 22px;height: 22px; }.propervideo-expand {opacity: 1 !important;-webkit-transition: opacity 0.5s ease-in-out;transition: opacity 0.5s ease-in-out; }.propervideo-opening {opacity: 0 !important; }#propervideo-ad_container > div:first-child {position: absolute !important;width: 100% !important;height: 100% !important; }#propervideo-controls {bottom: 0;height: 36px;width: 100%;position: absolute;z-index: 4;opacity: 0;-webkit-transition: opacity 0.5s ease-in-out;transition: opacity 0.5s ease-in-out; }#propervideo-controls:before {content: \'\';position: absolute;border-radius: 0 0 2px 2px;z-index: 0;left: 0;bottom: -0.5px;width: 100%;height: 101px;background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.79) 63%); }#propervideo-controls .top-progress-bar {position: absolute;top: -7px;left: 15px;width: calc(100% - 30px);z-index: 9; }#propervideo-controls #propervideo-progress_bar {display: block;width: 100%;height: 7px;-webkit-appearance: none;cursor: pointer;background: none;margin: 0;padding: 0;background-color: #dededeb3;background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, var(--proper-video-accent-color)), color-stop(100%, var(--proper-video-accent-color)));background-size: 50% 100%;background-repeat: no-repeat;border-radius: 10px; }#propervideo-controls #propervideo-progress_bar:focus {outline: 0; }#propervideo-controls #propervideo-progress_bar::-webkit-slider-runnable-track {box-shadow: none;border: none;background: transparent;-webkit-appearance: none; }#propervideo-controls #propervideo-progress_bar::-webkit-slider-thumb {-webkit-appearance: none;width: 14px;height: 14px;border: 0;border-radius: 100px;cursor: pointer;background: white;box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.4); }#propervideo-controls #propervideo-progress_bar::-moz-range-progress,#propervideo-controls #propervideo-progress_bar::-ms-fill-lower {background-color: var(--proper-video-accent-color); }#propervideo-controls #propervideo-progress_bar::-moz-range-track,#propervideo-controls #propervideo-progress_bar::-ms-fill-upper {background-color: lightgrey; }#propervideo-controls #propervideo-quality-box {position: absolute;margin: 0;bottom: 42px;right: 27px;background: #232323db;list-style: none;padding: 0;opacity: 0;visibility: hidden;width: 138px;text-align: left; }#propervideo-controls .propervideo-quality-item {opacity: 1;color: white;height: 30px;display: flex;align-items: center;padding: 8px 0 8px 9px; }#propervideo-controls .propervideo-quality-item:hover {opacity: 1;color: #0c0c0c;background: #757575;cursor: pointer; }#propervideo-controls .propervideo-selected {color: #000000;background: #d4d4d4; }#propervideo-controls .propervideo-bottom-controls {display: flex;height: 100%;position: absolute;bottom: 2px;width: 100%;justify-content: space-between; }#propervideo-controls .propervideo-bottom-controls {/*.fullscreen{font-size: 16px;width: 30px;padding: 0;font-family: \'VideoJS\';margin: 0 1vh;display: block;justify-content: center;}*/ }#propervideo-controls .propervideo-bottom-controls #propervideo-time {color: white;opacity: 0.8; }#propervideo-controls .propervideo-bottom-controls .propervideo-left-group {height: 100%;display: flex;align-items: center; }#propervideo-controls .propervideo-bottom-controls .propervideo-left-group #propervideo-play_button {margin: 0 1vh; }#propervideo-controls .propervideo-bottom-controls .propervideo-left-group #propervideo-play_button .pv_play_icon {width: 13px; }#propervideo-controls .propervideo-bottom-controls .propervideo-left-group #propervideo-play_button .pv_pause_icon {width: 13px; }#propervideo-controls .propervideo-bottom-controls #propervideo-right-group {display: flex;align-items: center;margin-right: 15px;padding-right: 25px; }#propervideo-controls .propervideo-bottom-controls #propervideo-right-group #propervideo-replay_button {font-weight: bold;transform: scaleX(-1); }#propervideo-controls button {color: white;cursor: pointer;background: transparent;border: none;opacity: 0.8;font-size: 16px;width: 30px;height: 30px;padding: 0;display: flex;justify-content: center;align-items: center; }#propervideo-controls button:hover {opacity: 1; }#propervideo-controls button:focus {outline: 0; }#propervideo-progress-div:focus {outline: 0; }#propervideo-progress-div {display: block;width: 100%;height: 5px;-webkit-appearance: none;cursor: pointer;background: #dedede;overflow: hidden;margin: 0; }#propervideo-progress-div::-webkit-slider-runnable-track {height: 10px;-webkit-appearance: none;color: #13bba4;margin-top: -1px;cursor: pointer; }#propervideo-progress-div::-webkit-slider-thumb {width: 10px;-webkit-appearance: none;height: 10px;cursor: pointer;background: #1b1b1b;box-shadow: -800px 0 0 800px blue; }#propervideo-progress-div::-moz-range-progress {background-color: #0075ff; }#propervideo-progress-div::-moz-range-track {background-color: lightgrey; }#propervideo-progress-div::-ms-fill-lower {background-color: #0075ff; }#propervideo-progress-div::-ms-fill-upper {background-color: lightgrey; }#propervideo-volume-group {position: absolute;bottom: 7px;right: 15px;z-index: 5;line-height: normal; }#propervideo-mute_button {background: transparent;border: none;color: white;padding: 0;cursor: pointer; }#propervideo-mute_button svg {height: 17px;width: auto; }#propervideo-mute_button:focus {outline: 0; }#propervideo-mute_button:hover ~ #propervideo-volume_bar, #propervideo-volume_bar:hover {visibility: visible;opacity: 1; }#propervideo-volume_bar {visibility: hidden;opacity: 0;transition: visibility 0.5s, opacity 0.5s linear;width: 75px;vertical-align: middle;-webkit-appearance: none;cursor: pointer;background: white;height: 4px;align-self: center;transform: rotate(-90deg);position: absolute;bottom: 70px;right: -27px;padding: 0; }#propervideo-volume_bar::-webkit-slider-thumb {-webkit-appearance: none;background: white;cursor: pointer;width: 14px;height: 14px;border-radius: 10px; }.controls-div {bottom: 0;height: 1.4em;position: absolute;overflow: hidden;display: none;opacity: 1;background-color: rgba(7, 20, 30, 0.7);background: linear-gradient(to top, rgba(7, 20, 30, 0.7) 0, rgba(7, 20, 30, 0) 100%);filter: progid; }.countdown-div {color: #FFF;text-shadow: 0 0 0.2em #000;cursor: default;text-align: center;line-height: normal; }.seek-bar-div {top: 1.2em;height: .3em;position: absolute;background: rgba(255, 255, 255, 0.4); }.play-pause-div, .mute-div, .slider-div, .fullscreen-div {width: 2.33em;height: 1.33em;top: .733em;left: 0;position: absolute;color: #CCC;font-size: 1.5em;line-height: 2;text-align: center;font-family: VideoJS;cursor: pointer; }.mute-div {left: auto;right: 5.667em; }.slider-div {left: auto;height: 4px;top: 36px;right: 2.6em;width: 3.33em;background-color: #555; }.slider-level-div {width: 100%;height: .667em;background-color: #ECC546; }.fullscreen-div {left: auto;right: 0; }.controls-div-showing {display: block !important;height: 3.7em !important; }.progress-div {width: 0;height: .3em;background-color: #ECC546; }.vjs-control-bar {z-index: 4; }#propervideo-content_video {overflow: hidden; }#propervideo-content_video, #propervideo-ad_container {position: absolute;top: -0.5px;left: -0.5px;width: calc(100% + 1.5px);height: calc(100% + 1.5px);box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05), 0 0 0 1px rgba(255, 255, 255, 0.1); }.propervideo-main_player_container {width: 100%;display: flex;transform-origin: top; }#propervideo-back_image {width: 100%;height: 100%;position: absolute;top: 0;left: 0; }#propervideo-controls-div svg, .propervideo-bottom-controls svg {height: 17px;width: auto; }#propervideo-video_overlay_link {display: flex;align-items: center;height: 100%;position: absolute;background-position: center;background-size: 14%;background-repeat: no-repeat;justify-content: center;width: 100%;z-index: 0;cursor: pointer;-webkit-transition: opacity 0.5s ease-in-out;transition: opacity 0.5s ease-in-out;top: 0px;opacity: 0; }#propervideo-video_overlay_link .pv_overlay_play_button,#propervideo-video_overlay_link .pv_overlay_pause_button {filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.65)); }#propervideo-video_overlay_link .pv_expand_icon, #propervideo-video_overlay_link .pv_pause_icon, #propervideo-video_overlay_link .pv_overlay_play_button, #propervideo-video_overlay_link .pv_overlay_pause_button, #propervideo-video_overlay_link .pv_overlay_expand_button, #propervideo-video_overlay_link .pv_clickthrough_button, #propervideo-video_overlay_link .pv_restart_icon {color: white;width: 55px;height: 55px;display: flex;margin: auto; }#propervideo-ad_container {overflow: hidden; }#propervideo-ad_container, #propervideo-content_video, #propervideo-video_container, #outer_propervideo-back_image, #propervideo-video_overlay_link, #propervideo-controls {border-radius: 3px; }@media (max-width: 768px) {#propervideo-video_container.propervideo-bottom_player {bottom: 50px; } }@media (max-width: 500px) {#propervideo-volume-group {bottom: 4px;right: 12px; }#clickthrough_url_button {font-size: 12px !important; }#propervideo-video_container {font-size: 11px !important;line-height: 1.5; }#propervideo-overlay-title {padding: 3px 0;box-shadow: -5px 0 0 0 var(--proper-video-accent-color), 5px 0 0 0 var(--proper-video-accent-color); }#propervideo-play_button {margin: 0; }#propervideo-controls {height: 30px; }#propervideo-controls .propervideo-bottom-controls .top-progress-bar {top: -5px; }#propervideo-controls .propervideo-bottom-controls #propervideo-time {font-size: 18px; }#propervideo-controls .propervideo-bottom-controls #propervideo-right-group button, #propervideo-controls .propervideo-bottom-controls #propervideo-right-group .fullscreen {margin: 0; }#propervideo-video_container.propervideo-bottom_player {max-width: 230px;max-height: 130px; }.pv_expand_icon,.pv_pause_icon,.pv_overlay_play_button,.pv_overlay_pause_button,.pv_overlay_expand_button,.pv_clickthrough_button, .pv_restart_icon {width: 40px;height: 40px; } }";style.innerHTML=css;document.getElementsByTagName('head')[0].appendChild(style);var pv_expand_icon="<svg class=\"pv_icon pv_expand_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">"+
"<path fill=\"currentColor\" d=\"M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 "+
"12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 "+
"0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 "+
"5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 "+
"468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 "+
"24 24 24h124c6.6 0 12-5.4 12-12z\"></path>"+
"</svg>";var pv_play_icon="<svg class=\"pv_icon pv_play_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">"+
"<path fill=\"currentColor\" d=\"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 "+
"72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z\"></path>"+
"</svg>";var pv_times_icon="<svg id=\"propervideo-svg-close-box\" class=\"pv_icon pv_times_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\">"+
"<path fill=\"currentColor\" d=\"M207.6 256l107.72-107.72c6.23-6.23 6.23-16.34 0-22.58l-25.03-25.03c-6.23-6.23-16.34-6.23-22.58 "+
"0L160 208.4 52.28 100.68c-6.23-6.23-16.34-6.23-22.58 0L4.68 125.7c-6.23 6.23-6.23 16.34 0 22.58L112.4 "+
"256 4.68 363.72c-6.23 6.23-6.23 16.34 0 22.58l25.03 25.03c6.23 6.23 16.34 6.23 22.58 0L160 303.6l107.72 "+
"107.72c6.23 6.23 16.34 6.23 22.58 0l25.03-25.03c6.23-6.23 6.23-16.34 0-22.58L207.6 256z\"></path>"+
"</svg>";var pv_pause_icon="<svg class=\"pv_icon pv_pause_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">"+
"<path fill=\"currentColor\" d=\"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 "+
"21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 "+
"21.5 48 48 48h96c26.5 0 48-21.5 48-48z\"></path>"+
"</svg>";var pv_restart_icon="<svg class=\"pv_icon pv_restart_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">"+
"<path fill=\"currentColor\" d=\"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 "+
"25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 "+
"0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 "+
"73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 "+
"11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 "+
"119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z\"></path>"+
"</svg>";var pv_volume_mute_icon="<svg class=\"pv_icon pv_volume_mute_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">"+
"<path fill=\"currentColor\" d=\"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 "+
"24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 "+
"256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 "+
"0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 "+
"301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z\"></path>"+
"</svg>";var pv_volume_up_icon="<svg class=\"pv_icon pv_volume_up_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\">"+
"<path fill=\"currentColor\" d=\"M256 88.017v335.964c0 21.438-25.943 31.998-40.971 16.971L126.059 352H24c-13.255 "+
"0-24-10.745-24-24V184c0-13.255 10.745-24 24-24h102.059l88.971-88.954c15.01-15.01 40.97-4.49 40.97 16.971zm182.056-77.876C422.982.92 "+
"403.283 5.668 394.061 20.745c-9.221 15.077-4.473 34.774 10.604 43.995C468.967 104.063 512 174.983 512 256c0 73.431-36.077 142.292-96.507 "+
"184.206-14.522 10.072-18.129 30.01-8.057 44.532 10.076 14.528 30.016 18.126 44.531 8.057C529.633 438.927 576 350.406 576 "+
"256c0-103.244-54.579-194.877-137.944-245.859zM480 256c0-68.547-36.15-129.777-91.957-163.901-15.076-9.22-34.774-4.471-43.994 "+
"10.607-9.22 15.078-4.471 34.774 10.607 43.994C393.067 170.188 416 211.048 416 256c0 41.964-20.62 81.319-55.158 105.276-14.521 "+
"10.073-18.128 30.01-8.056 44.532 6.216 8.96 16.185 13.765 26.322 13.765a31.862 31.862 0 0 0 18.21-5.709C449.091 377.953 480 "+
"318.938 480 256zm-96 0c0-33.717-17.186-64.35-45.972-81.944-15.079-9.214-34.775-4.463-43.992 10.616s-4.464 34.775 10.615 "+
"43.992C314.263 234.538 320 244.757 320 256a32.056 32.056 0 0 1-13.802 26.332c-14.524 10.069-18.136 30.006-8.067 44.53 10.07 "+
"14.525 30.008 18.136 44.53 8.067C368.546 316.983 384 287.478 384 256z\"></path>"+
"</svg>";var pv_cog_icon="<svg class=\"pv_icon pv_cog_icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">"+
"<path fill=\"currentColor\" d=\"M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 "+
"35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 "+
"35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 "+
"191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 "+
"5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 "+
"29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 "+
"12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 "+
"0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 "+
"11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 "+
"80 80-35.888 80-80z\"></path>"+
"</svg>";var pv_overlay_play_button="<svg class=\"pv_overlay_play_button\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 500.000000 500.000000\">"+
"<g transform=\"translate(0.000000,500.000000) scale(0.100000,-0.100000)\" fill=\"currentColor\" stroke=\"none\">"+
"<path d=\"M595 4660 c-61 -13 -94 -28 -145 -65 -59 -43 -95 -96 -126 -180 l-24 -66 0 -1851 0 -1852 21 -60 c50 -140 132 -214 282 -252 62 -15 68 -15 140 5 50 14 234 100 549 257 260 130 923 459 1473 731 1545 765 1771 880 1813 917 48 44 87 116 105 193 13 54 13 66 -4 134 -23 89 -74 168 -137 211 -24 17 -211 112 -415 213 -205 100 -1031 510 -1837 910 -806 400 -1482 733 -1502 741 -51 18 -144 25 -193 14z\"></path>"+
"</g>"+
"</svg>";var pv_overlay_pause_button="<svg class=\"pv_overlay_pause_button\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 500.000000 500.000000\">"+
"<g transform=\"translate(0.000000,500.000000) scale(0.100000,-0.100000)\" fill=\"currentColor\" stroke=\"none\">"+
"<path d=\"M541 4786 c-53 -30 -50 107 -51 -2293 0 -1710 3 -2238 12 -2258 25 -56 8 -55 763 -55 755 0 738 -1 763 55 9 20 12 548 12 2256 0 2426 4 2270 -55 2297 -40 18 -1411 16 -1444 -2z\"></path>"+
"<path d=\"M3031 4786 c-53 -30 -50 107 -51 -2293 0 -1710 3 -2238 12 -2258 25 -56 8 -55 763 -55 755 0 738 -1 763 55 9 20 12 548 12 2256 0 2426 4 2270 -55 2297 -40 18 -1411 16 -1444 -2z\"></path>"+
"</g>"+
"</svg>";var pv_clickthrough_button="<svg class=\"pv_clickthrough_button\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 500.000000 500.000000\">"+
"<g transform=\"translate(0.000000,500.000000) scale(0.100000,-0.100000)\" fill=\"currentColor\" stroke=\"none\">"+
"<path d=\"M449 4666 c-153 -41 -261 -169 -280 -333 -6 -46 -9 -697 -7 -1593 l3 -1515 22 -53 c63 -154 190 -241 364 -250 l86 -4 5 -102 c7 -128 32 -196 98 -269 27 -30 77 -69 112 -88 l63 -34 1835 0 1835 0 55 29 "+
"c103 53 188 156 205 249 4 21 11 40 16 43 12 7 12 3079 0 3102 -5 9 -15 39 -22 66 -7 26 -31 74 -54 105 -74 101 -173 150 -316 158 l-87 6 -4 111 c-4 94 -9 120 -31 167 -36 74 -104 141 -185 181 l-67 33 -1800 2 c-1405 1 -1810 -1 -1846 -11z m195 -310 c48 -20 76 -61 76 -110 0 -113 -128 -167 -204 -87 -58 60 -40 157 35 194 42 20 51 21 93 3z m426 -15 c14 -9 33 -34 43 -54 17 -33 17 -42 5 -79 -16 -49 -51 -78 -104 -84 -48 -6 -81 11 -111 55 -42 62 -20 135 50 171 46 22 76 20 117 -9z "+
"m367 18 c73 -27 107 -96 79 -162 -29 -71 -113 -97 -177 -54 -83 56 -66 177 31 216 33 13 34 13 67 0z m2703 -1759 c0 -1434 3 -1345 -55 -1400 l-27 -25 -1761 -3 c-1238 -2 -1773 0 -1799 8 -28 8 -44 21 -63 54 l-25 43 0 1321 0 1322 1865 0 1865 0 0 -1320z m470 -430 c0 -1576 6 -1451 -73 -1489 l-44 -21 -1754 2 c-1672 3 -1756 4 -1782 21 -50 32 -67 73 -67 159 l0 78 1597 2 1598 3 57 23 c63 25 147 96 183 152 57 90 55 42 55 1312 l0 1168 115 0 115 0 0 -1410z\"></path>"+
"<path d=\"M2273 3494 c-61 -30 -63 -45 -63 -418 l0 -336 -332 0 c-312 0 -334 -1 -373 -20 -91 -44 -88 -167 5 -215 24 -12 88 -15 364 -15 l335 0 3 -351 3 -351 32 -29 c59 -52 113 -51 170 6 l33 33 0 346 0 346 335 0 c364 0 371 1 414 56 29 36 28 102 -1 139 -41 53 -59 55 -418 55 l-330 0 0 344 c0 333 -1 344 -21 370 -42 54 -99 68 -156 40z\"></path>"+
"</g>"+
"</svg>";var pv_overlay_expand_button="<svg class=\"pv_overlay_expand_button\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 500.000000 501.000000\">"+
"<g transform=\"translate(0.000000,501.000000) scale(0.100000,-0.100000)\" fill=\"currentColor\" stroke=\"none\">"+
"<path d=\"M785 4749 c-226 -33 -414 -180 -490 -384 -57 -152 -55 -67 -55 -1861 0 -1611 0 -1653 20 -1745 56 -266 233 -443 499 -499 92 -20 134 -20 1741 -20 1607 0 1649 0 1741 20 268 57 445 236 499 504 19 95 20 134 18 831 l-3 731 -30 59 "+
"c-25 50 -39 64 -85 88 -47 25 -63 28 -109 23 -67 -6 -126 -44 -158 -101 l-23 -40 0 -751 c0 -839 1 -819 -67 -886 -21 -20 -51 -42 -66 -47 -20 -8 -553 -11 -1718 -11 -1662 0 -1690 0 -1728 20 -51 26 -97 82 -110 136 -14 54 -15 3309 -1 3368 12 55 58 115 105 140 39 21 53 21 815 26 "+
"862 6 803 1 868 74 85 97 53 250 -64 307 l-49 24 -745 1 c-410 1 -772 -2 -805 -7z\"></path>"+
"<path d=\"M3280 4751 c-100 -31 -160 -105 -160 -198 0 -66 34 -130 88 -168 l44 -30 399 -3 c219 -1 399 -6 399 -10 0 -4 -381 -387 -846 -852 -579 -579 -852 -858 -865 -885 -60 -128 39 -285 179 -285 86 0 59 -24 962 877 470 469 858 853 862 "+
"853 4 0 7 -176 8 -391 0 -366 2 -393 20 -429 54 -106 177 -139 284 -76 36 21 51 39 76 90 l30 64 0 622 c0 694 1 687 -69 760 -67 70 -64 70 -765 69 -342 0 -632 -4 -646 -8z\"></path>"+
"</g>"+
"</svg>";var Application=function(){this.SAMPLE_AD_TAG='https://pubads.g.doubleclick.net/'+
'gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&'+
'ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&'+
'unviewed_position_start=1&'+
'cust_params=deployment%3Ddevsite%26sample_ct%3Dlinear&correlator=';this.log_lines=[];this.playing=false;this.ads_active=false;this.ads_called=false;this.fullscreen=false;this.set_video_called=false;this.fullscreen_width=null;this.fullscreen_height=null;this.fullscreen_clicked=false;this.ad_tag_url='';this.ad_tag_type='';this.video_id='';this.slot_name='';this.div_name='';this.site_name='';this.site='';this.device_type='';this.observer=null;this.scroll_item=null;this.scroll_started=false;this.no_ads_no_player=false;this.finish_start_everything_called=false;this.proper_ops=reset_proper_ops();this.video_player=null;this.ads=null;this.inview=null;};Application.prototype.log=function(message){this.log_lines.push(message);if(this.proper_ops.proper_logging){if(typeof message=="string")console.log("ProperVideo ("+this.div_name+"): "+message);else console.log(message);}};Application.prototype.set_video_ended_callback_enabled=function(enable){if(enable)this.video_player.register_video_ended_callback(this.video_ended_callback);else this.video_player.remove_video_ended_callback(this.video_ended_callback);};Application.prototype.resume_after_ad=function(){this.log("Resuming video after ads have played");if(this.video_player.video_started)this.video_player.play();this.ads_active=false;this.inview.re_observe();};Application.prototype.pause_for_ad=function(){this.ads_active=true;this.playing=true;if(this.video_player.video_started)this.video_player.pause();};Application.prototype.bind=function(thisObj,fn){return function(){fn.apply(thisObj,arguments);};};Application.prototype.on_fullscreen_click=function(){if(this.fullscreen_clicked==true)return;this.fullscreen_clicked=true;if(this.fullscreen){var cancel_fullscreen=document.exitFullscreen||document.exitFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;if(cancel_fullscreen&&document.fullscreenElement)cancel_fullscreen.call(document);else this.on_fullscreen_change();}
else{this.video_player.switch_player("main");var request_fullscreen=document.documentElement.request_fullscreen||document.documentElement.webkitRequestFullscreen||document.documentElement.mozRequestFullscreen||document.documentElement.requestFullScreen||document.documentElement.webkitRequestFullScreen||document.documentElement.mozRequestFullScreen;if(request_fullscreen){this.fullscreen_width="100vw";this.fullscreen_height="100vh";request_fullscreen.call(document.documentElement);}
else{this.fullscreen_width="100vw";this.fullscreen_height="100vh";this.on_fullscreen_change();}}};Application.prototype.load_ads=function(){this.video_player.remove_preload_listener();this.ads.request_ads(this.ad_tag_url,this.ad_tag_type);};Application.prototype.on_fullscreen_change=function(){if(this.fullscreen){this.ads.resize(this.width,this.height);add_style($("#"+this.div_name+" #propervideo-video_container").obj,"max-width","");add_style($("#"+this.div_name+" #propervideo-video_container").obj,"max-height","");add_style($("#"+this.div_name+" #propervideo-ad_container").obj,"border-radius","");add_style($("#"+this.div_name+" #propervideo-content_video").obj,"border-radius","");add_style($("#"+this.div_name+" #propervideo-video_container").obj,"border-radius","");add_style($("#"+this.div_name+" #propervideo-back_image").obj,"border-radius","");add_style($("#"+this.div_name+" #propervideo-video_overlay_link").obj,"border-radius","");if(!this.ads.ad_playing)add_style($("#"+this.div_name+" #clickthrough_button").obj,"display","");add_style($("#"+this.div_name+" #propervideo-overlay-title").obj,"display","");add_style($("body").obj,"overflow","");this.video_player.resize('','','','','','','');this.fullscreen=false;this.inview.re_observe();}
else{if(this.fullscreen_clicked==false)return;this.fullscreen_clicked=false;var width=this.fullscreen_width+"px";var height=this.fullscreen_height+"px";this.make_ads_fullscreen();this.video_player.resize('fixed',"0px","0px",width,height,99999999999,0);this.fullscreen=true;}};Application.prototype.make_ads_fullscreen=function(){add_style($("#"+this.div_name+" #propervideo-video_container").obj,"max-width","none");add_style($("#"+this.div_name+" #propervideo-video_container").obj,"max-height","none");add_style($("#"+this.div_name+" #propervideo-ad_container").obj,"border-radius","unset");add_style($("#"+this.div_name+" #propervideo-content_video").obj,"border-radius","unset");add_style($("#"+this.div_name+" #propervideo-video_container").obj,"border-radius","unset");add_style($("#"+this.div_name+" #propervideo-back_image").obj,"border-radius","unset");add_style($("#"+this.div_name+" #propervideo-video_overlay_link").obj,"border-radius","unset");add_style($("#"+this.div_name+" #clickthrough_button").obj,"display","none");add_style($("#"+this.div_name+" #propervideo-overlay-title").obj,"display","none");add_style($("body").obj,"overflow","hidden");this.ads.resize(this.fullscreen_width,this.fullscreen_height);}
Application.prototype.on_content_ended=function(){this.ads.content_ended();};Application.prototype.quality_switch=function(video_id,quality){this.quality_switch(video_id,quality);}
Application.prototype.toggle_quality_box=function(){this.toggle_quality_box();}
Application.prototype.get_device_type=function(){var ua=navigator.userAgent.toLowerCase();var device_type="";if(/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(ua))device_type="tablet";else if(/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(ua))device_type="mobile";else device_type="desktop";return device_type;}
Application.prototype.multi_auction_callback=function(bids={}){global_ops.ad_count++;if(global_ops.ad_count>this.proper_ops.number_of_ads){this.log("Halt because ad limit");return;}
this.log("Multi callback Called");var ad_type="";var html="";if(bids){this.log(bids);if(bids.display.cpm>bids.outstream.cpm)ad_type="display";else if(bids.display.cpm<=bids.outstream.cpm)ad_type="outstream";if(ad_type=="display"){if($("#"+this.div_name+" #proper-ad-unit-container-div").obj){this.log("Refreshing Display Slot");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.refreshSlotByName"))window.ProperMedia.ad_project.refreshSlotByName(this.proper_ops.backfill_id,true);return;}
if(!this.video_player||!this.ads){this.video_player=new VideoPlayer(this);this.ads=new Ads(this,this.video_player);}
this.ads.proper_backfill(false);}
else if(ad_type=="outstream"){if($("#"+this.div_name+" #proper-ad-unit-container-div").obj){var elem=$("#"+this.div_name+" #proper-ad-unit-container-div").obj;elem.parentNode.removeChild(elem);properDestroyDfpSlot(this.proper_ops.backfill_id);}
this.finish_start_everything(true);}}}
Application.prototype.start_everything=function(div_id,slot_id,site){this.log("display called for video slot: "+slot_id);this.slot_name=slot_id;this.div_name=div_id;this.site=site;this.device_type=this.get_device_type();if(this.scroll_item==null)this.inview.start_in_view();var multi_auction=$("#"+div_id).attr("data-multi_auction");if(multi_auction==="multi_auction"){this.proper_ops.multi_auction=true;if(window.ProperMedia)this.initiate_multi_auction();else window.addEventListener("proper-has-been-loaded",this.initiate_multi_auction.bind(this));return;}
else this.proper_ops.multi_auction=false;this.finish_start_everything(false);}
Application.prototype.initiate_multi_auction=function(){this.log("Getting Multi Auction Ads");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.revContInit"))window.ProperMedia.ad_project.revContInit(this.multi_auction_callback.bind(this),['outstream','display']);}
Application.prototype.finish_start_everything=function(outstream_override){if($("#"+this.div_name+" #propervideo-super_outer_container").obj)return;this.log("finishing start_everything");this.video_player=new VideoPlayer(this);this.ads=new Ads(this,this.video_player);var fullscreen_events=['fullscreenchange','mozfullscreenchange','webkitfullscreenchange'];for(key in fullscreen_events){document.addEventListener(fullscreen_events[key],this.bind(this,this.on_fullscreen_change),false);}
var outstream=$("#"+this.div_name).attr("data-outstream");if(outstream=="outstream"||outstream_override){this.proper_ops.video_type="outstream";}
this.video_player.create_player_html(this.ads);if(this.proper_ops.video_type=="outstream")add_style($("#"+this.div_name+" #propervideo-main_container").obj,"background","black");var video_id=$("#"+this.div_name).attr("data-video-id");this.video_id=video_id;var split=video_id.split("-");this.site_name=split[0];this.video_player.content_player=$("#"+this.div_name+" #propervideo-content_video").obj;this.video_player.video_player_container=$("#"+this.div_name+" #propervideo-video").obj;this.ads.setup_ad_controls();var video_url=$("#"+this.div_name).attr("data-hls-url");if(video_url!=null&&video_url!=""&&this.video_player.supportsHLS())this.video_url=video_url;else{video_url=$("#"+this.div_name).attr("data-mpd-url");if(video_url!=null&&video_url!=""&&this.device_type=="desktop")this.video_url=video_url;else{video_url=$("#"+this.div_name).attr("data-video-url");if(video_url!=null&&video_url!="")this.video_url=video_url;}}
if(this.proper_ops.video_type=="outstream"){add_style($("#"+this.div_name+" #propervideo-volume-group").obj,"display","none");add_style($("#"+this.div_name+" #propervideo-video_quality").obj,"display","none");this.no_ads_no_player=true;this.video_player.isolated=true;this.video_player.overwrite_proper_ops([],this.div_name);this.ads.initial_user_action();}
else if(this.video_url&&this.video_url!=""){if(this.video_url.endsWith(".mpd"))this.video_player.video_type="mpeg-dash";else if(this.video_url.endsWith(".m3u8"))this.video_player.video_type="hls";else this.video_player.video_type="mp4";if($("#"+this.div_name).attr("data-video-image"))$("#"+this.div_name+" #propervideo-back_image").obj.src=$("#"+this.div_name).attr("data-video-image");if($("#"+this.div_name).attr("data-video-title"))$("#"+this.div_name+" #propervideo-overlay-title").obj.innerHTML=$("#"+this.div_name).attr("data-video-title");add_style($("#"+this.div_name+" #propervideo-video_quality").obj,"display","none");var clickthrough_url=$("#"+this.div_name).attr("data-clickthrough-url");if(clickthrough_url!=null&&clickthrough_url!="")this.video_player.clickthrough_url=clickthrough_url;if(this.video_player.clickthrough_url&&this.video_player.clickthrough_url!=""&&this.video_player.clickthrough_url!=win.location.href){var button_container=$("#"+this.div_name+" #clickthrough_button").obj;var button=document.createElement("a");button.setAttribute("id","clickthrough_url_button");button.setAttribute("href",this.video_player.clickthrough_url);button.setAttribute("target","_blank");if(this.site=="tvtropes")var button_text=document.createTextNode("Show Trope Page");else var button_text=document.createTextNode("Go To Video Page");button.appendChild(button_text);button_container.appendChild(button);}
this.video_player.overwrite_proper_ops([],this.div_name);this.video_ended_callback=this.bind(this,this.on_content_ended);this.set_video_ended_callback_enabled(true);this.ads.initial_user_action();}
else{this.video_player.get_video_info(this.video_id,this.site);}
this.width=$("#"+this.div_name+" #propervideo-content_video").obj.offsetWidth;this.height=$("#"+this.div_name+" #propervideo-content_video").obj.offsetHeight;}
Application.prototype.set_dfp_floor=function(price){application.ads.set_dfp_floor(price);}
var Ads=function(application,video_player){this.application=application;this.video_player=video_player;this.application.log("Creating a new Ads class");this.ad_display_container=null;this.ads_loader=null;this.ads_manager=null;this.ad_bar_counter=null;this.can_show_ad_container=false;this.ad_error=0;this.ad_play_count=0;this.current_ad_duration=0;this.physical_time_reached=false;this.dfp_bid=0;this.current_bidder='';this.current_bid=0;this.control_bar="";this.ad_volume=0;this.ad_muted=true;this.time_until_ad=15000;this.dfp_price_floor=0.5;this.ima_script_called=false;this.content_complete_called=false;this.control_bar_listener_called=false;this.imaSdkSrc='https://imasdk.googleapis.com/js/sdkloader/ima3.js';};Ads.prototype.initial_user_action=function(){if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoPlayerOps")&&this.video_player.getVideoPlayerOps_called==false){this.video_player.overwrite_proper_ops(this.video_player.overwrite_data,this.video_player.overwrite_id);}
if(this.application.proper_ops.number_of_ads==0&&this.application.proper_ops.video_type!="outstream"){this.application.log("Not displaying ads");document.documentElement.style.setProperty('--small_player_bottom',this.application.proper_ops.small_player_bottom+"px");if(!this.video_player.video_started)this.video_player.set_video("no_ads");}
else if(this.application.proper_ops.autoplay==1||this.video_player.initial_play_clicked==1||this.application.proper_ops.video_type=="outstream"){this.load_ima_script();}
else{this.application.log("Waiting for click to display ads");if(!this.video_player.video_started)this.video_player.set_video();}};Ads.prototype.load_ima_script=function(){if(this.ima_script_called)return;this.ima_script_called=true;this.loadScript(this.imaSdkSrc).then(ima=>{if(this.application.proper_ops.number_of_ads==0)return;this.application.log("IMA SDK successfully loaded!");this.video_player.ad_container=$("#"+this.application.div_name+" #propervideo-ad_container").obj;google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);this.ad_display_container=new google.ima.AdDisplayContainer(this.video_player.ad_container,this.video_player.content_player);this.ads_loader=new google.ima.AdsLoader(this.ad_display_container);this.ads_loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.on_ads_manager_loaded,false,this);this.ads_loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.on_ad_error,false,this);if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoAd")){this.application.log("Proper has been loaded");document.documentElement.style.setProperty('--small_player_bottom',this.application.proper_ops.small_player_bottom+"px");var video_ad=window.ProperMedia.ad_project.getVideoAd(this.application.slot_name);this.application.log(video_ad);if(!video_ad&&!video_ad.auction){this.ad_error=this.application.proper_ops.ad_failure_limit;this.application.log("Nothing returned from Proper");if(this.application.proper_ops.backfill==true&&this.ad_play_count==0)this.video_player.destroy_player();else{if(this.ads_manager)this.ads_manager.destroy();document.addEventListener("proper-has-been-loaded",this.application.bind(this,this.move_to_next_auction));setTimeout(function(){this.application.log("Wait for Proper to finish loading before attempting to get another ad");this.move_to_next_auction();}.bind(this),2000);if(!this.video_player.video_started)this.video_player.set_video();this.application.resume_after_ad();}}
else if(video_ad.auction.finished==false){setTimeout(function(){this.application.log("Wait for Proper to finish loading before attempting to get another ad");var video_ad=window.ProperMedia.ad_project.getVideoAd(this.application.slot_name);this.application.log(video_ad);this.check_to_display_ad(video_ad);}.bind(this),video_ad.auction.time_remaining);}
else if(video_ad.auction.finished==true){this.check_to_display_ad(video_ad);}}
else{this.application.log("Proper has NOT been loaded");document.documentElement.style.setProperty('--small_player_bottom',this.application.proper_ops.small_player_bottom+"px");document.addEventListener("proper-has-been-loaded",this.application.bind(this,this.move_to_next_auction));setTimeout(function(){this.application.log("Wait for Proper to finish loading before attempting to get another ad");this.move_to_next_auction();}.bind(this),2000);if(!this.video_player.video_started)this.video_player.set_video();this.application.resume_after_ad();}}).catch(()=>{this.application.log("SDK could not be loaded. Check your ad blocker!");if(!this.video_player.video_started)this.video_player.set_video();this.application.inview.re_observe();});}
Ads.prototype.loadScript=function(src){return new Promise((resolve,reject)=>{const script=document.createElement('script');script.async=true;script.src=src;script.onload=resolve;script.onerror=reject;document.body.appendChild(script);});};Ads.prototype.request_ads=function(vast_tag,vast_type){var ads_request=new google.ima.AdsRequest();if(vast_type=="url")ads_request.adTagUrl=vast_tag;else ads_request.adsResponse=vast_tag;ads_request.vastLoadTimeout=this.application.proper_ops.vast_timeout;ads_request.linearAdSlotWidth=this.application.width;ads_request.linearAdSlotHeight=this.application.height;ads_request.nonLinearAdSlotWidth=this.application.width;ads_request.nonLinearAdSlotHeight=this.application.height;ads_request.setAdWillPlayMuted(true);ads_request.setAdWillAutoPlay(true);this.ads_loader.requestAds(ads_request);};Ads.prototype.pause=function(){this.ad_paused=true;$("#"+this.application.div_name+" #propervideo-play-pause-div").html(pv_play_icon);if(this.ads_manager)this.ads_manager.pause();};Ads.prototype.resume=function(){this.ad_paused=false;$("#"+this.application.div_name+" #propervideo-play-pause-div").html(pv_pause_icon);if(this.ads_manager)this.ads_manager.resume();};Ads.prototype.resize=function(width,height){if(this.ads_manager)this.ads_manager.resize(width,height,google.ima.ViewMode.FULLSCREEN);};Ads.prototype.content_ended=function(){this.content_complete_called=true;if(this.ads_loader)this.ads_loader.contentComplete();};Ads.prototype.on_ads_manager_loaded=function(ads_manager_loaded_event){this.application.log('Ads loaded.');var ads_rendering_settings=new google.ima.AdsRenderingSettings();ads_rendering_settings.restoreCustomPlaybackStateOnAdBreakComplete=true;this.ads_manager=ads_manager_loaded_event.getAdsManager(this.video_player.content_player,ads_rendering_settings);this.start_ads_manager(this.ads_manager);};Ads.prototype.start_ads_manager=function(ads_manager){ads_manager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.on_content_pause_requested,false,this);ads_manager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.on_content_resume_requested,false,this);ads_manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.application.bind(this,this.on_ad_error),false,this);var events=[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE];for(var index in events){ads_manager.addEventListener(events[index],this.application.bind(this,this.on_ad_event),false,this);}
var init_width,init_height;if(this.application.fullscreen){init_width=this.application.fullscreen_width;init_height=this.application.fullscreen_height;}
else{init_width=this.application.width;init_height=this.application.height;}
ads_manager.init(init_width,init_height,google.ima.ViewMode.NORMAL);ads_manager.start();};Ads.prototype.on_content_pause_requested=function(){this.application.pause_for_ad();this.application.set_video_ended_callback_enabled(false);};Ads.prototype.on_content_resume_requested=function(){this.application.set_video_ended_callback_enabled(true);this.ad_paused=false;$("#"+this.application.div_name+" #propervideo-play-pause-div").html(pv_pause_icon);if(!this.content_complete_called&&this.video_player.video_started)this.application.resume_after_ad();};Ads.prototype.setup_ad_controls=function(){this.application.log("Setting up ad control bar");var ad_container_div=$("#"+this.application.div_name+" #propervideo-ad_container").obj;var controls_div=document.createElement('div');var countdown_div=document.createElement('div');var seek_bar_div=document.createElement('div');var progress_div=document.createElement('input');var play_pause_div=document.createElement('div');var mute_div=document.createElement('div');var slider_div=document.createElement('input');var fullscreen_div=document.createElement('div');this.video_player.assign_control_attributes(controls_div,'controls-div');controls_div.style.width='100%';this.video_player.assign_control_attributes(countdown_div,'countdown-div');countdown_div.innerHTML="Advertisement";countdown_div.style.display='block';this.video_player.assign_control_attributes(seek_bar_div,'seek-bar-div');seek_bar_div.style.width='100%';this.video_player.assign_control_attributes(progress_div,'progress-div');progress_div.setAttribute("type","range");progress_div.setAttribute("value","0");this.video_player.assign_control_attributes(play_pause_div,'play-pause-div');play_pause_div.innerHTML=pv_pause_icon;this.video_player.assign_control_attributes(mute_div,'mute-div');mute_div.innerHTML=pv_volume_mute_icon;this.video_player.assign_control_attributes(slider_div,'slider-div');slider_div.setAttribute("type","range");slider_div.setAttribute("min","0");slider_div.setAttribute("max","1");slider_div.setAttribute("step","0.1");slider_div.setAttribute("value","1");this.video_player.assign_control_attributes(fullscreen_div,'fullscreen-div');fullscreen_div.innerHTML=pv_expand_icon;ad_container_div.appendChild(controls_div);controls_div.appendChild(countdown_div);controls_div.appendChild(seek_bar_div);controls_div.appendChild(play_pause_div);controls_div.appendChild(mute_div);controls_div.appendChild(slider_div);controls_div.appendChild(fullscreen_div);seek_bar_div.appendChild(progress_div);}
Ads.prototype.ad_control_bar_listeners=function(){$("#"+this.application.div_name+" #propervideo-ad_container").obj.addEventListener('mouseenter',this.application.bind(this,this.show_ad_container));$("#"+this.application.div_name+" #propervideo-ad_container").obj.addEventListener('mouseleave',this.application.bind(this,this.hide_ad_container));$("#"+this.application.div_name+" #propervideo-fullscreen-div").obj.addEventListener('click',this.application.bind(this.application,this.application.on_fullscreen_click),false);$("#"+this.application.div_name+" #propervideo-play-pause-div").obj.addEventListener('click',function(){if(this.ad_paused)this.resume();else this.pause();}.bind(this));$("#"+this.application.div_name+" #propervideo-mute-div").obj.addEventListener('click',function(){if(this.ad_muted){var new_ad_volume=(this.ad_volume>0)?this.ad_volume:1
this.ads_manager.setVolume(new_ad_volume);this.ad_volume=new_ad_volume;$("#"+this.application.div_name+" #propervideo-slider-div").val(new_ad_volume);this.ad_muted=false;$("#"+this.application.div_name+" #propervideo-mute-div").html(pv_volume_up_icon);}
else{this.ads_manager.setVolume(0);this.ad_muted=true;$("#"+this.application.div_name+" #propervideo-slider-div").val(0);$("#"+this.application.div_name+" #propervideo-mute-div").html(pv_volume_mute_icon);}}.bind(this));$("#"+this.application.div_name+" #propervideo-slider-div").obj.addEventListener('change',function(){this.ads_manager.setVolume($("#"+this.application.div_name+" #propervideo-slider-div").val());this.ad_volume=$("#"+this.application.div_name+" #propervideo-slider-div").val();if($("#"+this.application.div_name+" #propervideo-slider-div").val()>0){this.ad_muted=false;$("#"+this.application.div_name+" #propervideo-mute-div").html(pv_volume_up_icon);}
else{$("#"+this.application.div_name+" #propervideo-mute-div").html(pv_volume_mute_icon);this.ad_muted=true;}}.bind(this));setInterval(function(){if((!this.ads_manager)||(!this.current_ad)||(!this.ad_playing))return;const remaining_time=this.ads_manager.getRemainingTime();const duration=this.current_ad.getDuration();var current_time=duration-remaining_time;current_time=current_time>0?current_time:0;current_time=(current_time/duration)*100;$("#"+this.application.div_name+" #propervideo-progress-div").val(current_time);}.bind(this),500);}
Ads.prototype.show_ad_container=function(){if(this.control_bar=="displayed"||!this.ad_playing||this.can_show_ad_container==false)return;this.control_bar="displayed";var controls_div=$("#"+this.application.div_name+" #propervideo-controls-div");add_style(controls_div.obj,"display","block");controls_div.addClass("controls-div-showing");if(this.application.device_type!="desktop"){setTimeout(function(){if(this.control_bar=="displayed")this.hide_ad_container();}.bind(this),3000);}}
Ads.prototype.hide_ad_container=function(){if(this.control_bar=="hidden")return;this.control_bar="hidden";var controls_div=$("#"+this.application.div_name+" #propervideo-controls-div");add_style(controls_div.obj,"display","none");controls_div.removeClass("controls-div-showing");}
Ads.prototype.on_ad_event=function(adEvent){this.application.log('Ad event: '+adEvent.type);var ad=adEvent.getAd();this.current_ad=ad;switch(adEvent.type){case google.ima.AdEvent.Type.LOADED:if(!this.control_bar_listener_called)this.ad_control_bar_listeners();this.control_bar_listener_called=true;this.ad_bar_counter=setInterval(myTimer.bind(this),500);function myTimer(){if((!this.ads_manager)||(!this.current_ad)||(!this.ad_playing)||(!$("#"+this.application.div_name+" #propervideo-progress-div").obj))return;const remaining_time=this.ads_manager.getRemainingTime();const duration=this.current_ad.getDuration();var current_time=duration-remaining_time;current_time=current_time>0?current_time:0;current_time=(current_time/duration)*100;$("#"+this.application.div_name+" #propervideo-progress-div").val(current_time);}
if(!this.application.set_video_called){this.application.set_video_called=true;this.video_player.control_bar_setup();this.video_player.player_options();this.video_player.player_tracking();}
add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","0");if(this.application.no_ads_no_player){add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"z-index","");add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"background","");add_style($("#"+this.application.div_name).obj,"transition","transform 0.3s ease-out");add_style($("#"+this.application.div_name).obj,"transform","scaleY(1)");add_style($("#"+this.application.div_name).obj,"transform","");this.resize(this.application.width,this.application.height);}
this.video_player.can_play=true;this.ad_paused=false;$("#"+this.application.div_name+" #propervideo-play-pause-div").html(pv_pause_icon);if((this.application.proper_ops.small_player=="desktop_ad"&&this.application.device_type=="desktop")||this.application.proper_ops.small_player=="always_ad"){this.video_player.small_player_can_open="true";}
add_style($("#"+this.application.div_name+" #clickthrough_button").obj,"display","none");break;case google.ima.AdEvent.Type.STARTED:add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"z-index","6");this.current_ad_duration=this.ads_manager.getRemainingTime()*1000;this.time_until_ad=this.ads_manager.getRemainingTime()*1000;if(this.application.proper_ops.video_type=="outstream"){setTimeout(function(){this.application.log("Calling for another auction");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.runVideoAuction"))window.ProperMedia.ad_project.runVideoAuction(this.application.proper_ops.video_type);}.bind(this),(this.current_ad_duration-1500));}
this.ad_paused=false;this.ad_playing=true;this.ad_play_count++;if(!this.video_player.content_player.paused&&(this.application.device_type=="desktop")&&this.application.proper_ops.video_type!="outstream")this.video_player.pause();if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoAdSuccess"))window.ProperMedia.ad_project.logVideoAdSuccess(this.application.slot_name,this.dfp_bid);this.dfp_bid=false
this.application.inview.re_observe();break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.application.log("Ads completed");this.ad_playing=false;if(!this.application.fullscreen)add_style($("#"+this.application.div_name+" #clickthrough_button").obj,"display","");add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"z-index","");clearInterval(this.ad_bar_counter);var event=new CustomEvent('propervideo-ads-finished');win.dispatchEvent(event);if(this.application.proper_ops.multi_auction==true){this.video_player.destroy_player();}
else if(this.application.proper_ops.video_type=="outstream"){this.current_ad=false;if(this.ad_play_count>=this.application.proper_ops.number_of_ads){this.video_player.destroy_player();}
else{this.move_to_next_auction(false);}}
else{this.ad_playing=false;if(!this.application.fullscreen)add_style($("#"+this.application.div_name+" #clickthrough_button").obj,"display","");add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"z-index","");if(!this.video_player.video_started)this.video_player.set_video();if(this.video_player.content_player.src!=this.application.video_url&&this.video_player.content_player.src!=""&&this.video_player.video_type=="mp4"){this.video_player.content_player.src=this.application.video_url;}
else if(this.video_player.video_type=="mpeg-dash"){var source_dash=$("#"+this.application.div_name+" #source_dash").obj;if(source_dash.src!=this.application.video_url)source_dash.src=this.application.video_url;}
if(this.video_player.player_time>0){this.application.log('set video to saved player time: '+this.video_player.player_time);this.video_player.content_player.currentTime=this.video_player.player_time;}
if(this.ad_play_count>=this.application.proper_ops.number_of_ads){this.video_player.switch_player("main");this.video_player.small_player_can_open="off";}
this.current_ad=false;if(this.current_ad_duration>0&&this.ad_play_count<this.application.proper_ops.number_of_ads){setTimeout(function(){if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.runVideoAuction"))window.ProperMedia.ad_project.runVideoAuction(this.application.proper_ops.video_type);}.bind(this),(this.current_ad_duration-2000));setTimeout(function(){this.application.log("Physical time gap reached");this.physical_time_reached=true;if(this.time_until_ad<=0&&(this.video_player.content_player.currentTime<=(this.video_player.content_player.duration-30))&&this.physical_time_reached&&(!this.video_player.video_paused)){this.move_to_next_auction(false);}}.bind(this),this.current_ad_duration);}
this.hide_ad_container();}
break;}};Ads.prototype.on_ad_error=function(adErrorEvent){this.application.log('Ad error: '+adErrorEvent.getError().toString());this.ad_error+=1;if(this.current_bidder=="dfp")this.dfp_bid=false;if(adErrorEvent.getError().g){var inner_error=adErrorEvent.getError().stack;var ad_specific_error=adErrorEvent.getError().g.errorMessage;var ad_error_code=adErrorEvent.getError().g.errorCode;}
else{var inner_error="A problem occurred";var ad_specific_error=adErrorEvent.getError().o+": "+adErrorEvent.getError().l;var ad_error_code=adErrorEvent.getError().h;}
var data={bidder:this.current_bidder,cpm:this.current_bid,device:this.application.device_type,err_code:ad_error_code,err_count:this.ad_error,err_message:ad_specific_error,useragent:navigator.userAgent.toLowerCase(),new_error:inner_error};if(this.current_bidder!="dfp"&&this.current_bidder!="dfp_floor"){$.ajax({method:"POST",url:global_ops.site_url+"/ajax/log_errors.php",data:JSON.stringify(data),timeout:10000,success:function(json){this.application.log("Error logged");}.bind(this)});}
if(this.ad_error>=this.application.proper_ops.ad_failure_limit&&this.ad_play_count==0)var last_error=true;else var last_error=false;var error_obj={"bidder":this.current_bidder,"msg":ad_specific_error};if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoAdError"))window.ProperMedia.ad_project.logVideoAdError(this.application.slot_name,error_obj,last_error);if(this.ad_error>=this.application.proper_ops.ad_failure_limit){if(this.ad_play_count<=0){this.application.log("Logging unfilled bid");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoUnfilled"))window.ProperMedia.ad_project.logVideoUnfilled(this.application.slot_name);}
var event=new CustomEvent('propervideo-ads-finished');win.dispatchEvent(event);if((!this.video_player.video_started&&this.application.no_ads_no_player)||this.application.proper_ops.video_type=="outstream"){this.video_player.can_play=false;this.video_player.destroy_player();return;}
this.ad_error=0;if(this.video_player.small_player_can_opn!="off"&&this.ad_play_count==0)this.video_player.small_player_can_opn="false";if(this.application.proper_ops.backfill==true&&this.ad_play_count==0)this.video_player.destroy_player();else{if(!this.video_player.video_started)this.video_player.set_video();this.application.inview.re_observe();this.schedule_another_auction();}}
else{if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoAd"))var video_ad=window.ProperMedia.ad_project.getVideoAd(this.application.slot_name);this.application.log(video_ad);if(!video_ad||video_ad.ad.bidder=="dfp_floor"){this.ad_error=0;if((!this.video_player.video_started&&this.application.no_ads_no_player)||this.application.proper_ops.video_type=="outstream"){this.video_player.can_play=false;this.video_player.destroy_player();return;}
if(this.ad_play_count<=0){this.application.log("Logging unfilled bid");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoUnfilled"))window.ProperMedia.ad_project.logVideoUnfilled(this.application.slot_name);}
this.application.log("No bids returned from Tyler after an error");if(this.application.proper_ops.backfill==true&&this.ad_play_count==0)this.video_player.destroy_player();else{if(!this.video_player.video_started)this.video_player.set_video();this.application.inview.re_observe();this.schedule_another_auction();}}
else{this.play_ad(video_ad.ad.vast_tag,video_ad.ad.vast_type);this.current_bidder=video_ad.ad.bidder;this.current_bid=video_ad.ad.price;}}};Ads.prototype.proper_backfill=function(unfilled_override){if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoUnfilled")&&this.ad_play_count<=0&&(this.application.proper_ops.multi_auction==false||unfilled_override)){this.application.log("Logging unfilled impression");window.ProperMedia.ad_project.logVideoUnfilled(this.application.slot_name);}
if(this.application.proper_ops.backfill_id=="")this.application.proper_ops.backfill_id="salon_revcont_1";this.application.log("Backfill enabled for: "+this.application.proper_ops.backfill_id);var proper_ad=document.createElement("script");var ad_text=document.createTextNode("propertag.cmd.push(function() { proper_display(\""+this.application.proper_ops.backfill_id+"\"); })");proper_ad.appendChild(ad_text);var ad_container=document.createElement("div");ad_container.setAttribute("class","proper-ad-unit");ad_container.setAttribute("id","proper-ad-unit-container-div");var ad_sub_cont=document.createElement("div");ad_sub_cont.setAttribute("id","proper-ad-"+this.application.proper_ops.backfill_id);ad_container.appendChild(ad_sub_cont);ad_sub_cont.appendChild(proper_ad);var container=$("#"+this.application.div_name).obj;$("#"+this.application.div_name).obj.parentNode.insertBefore(ad_container,container);}
Ads.prototype.check_to_display_ad=function(video_ad){this.application.log("Checking to see if we are attempting to displaying this ad or not");if(video_ad.ad.bidder=="dfp_floor"){this.application.log("Proper didn't return a bid, still try DFP though");this.hide_ad_container();this.current_bidder="dfp";this.current_bid=video_ad.ad.price;if(this.application.proper_ops.video_type=="outstream"){if(this.ad_play_count<=0){this.application.log("Logging unfilled bid");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoUnfilled"))window.ProperMedia.ad_project.logVideoUnfilled(this.application.slot_name);}
var error_obj={"bidder":"dfp_floor","msg":"No DFP for outstream"};if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.logVideoAdError"))window.ProperMedia.ad_project.logVideoAdError(this.application.slot_name,error_obj,true);if(this.application.proper_ops.backfill==true)this.proper_backfill(true);else this.video_player.destroy_player();}
else if(this.video_player.isolated==false&&this.ad_error==0&&this.application.proper_ops.dfp_ad_unit!="")this.send_DFP(video_ad.ad);}
else{if(!video_ad.ad.vpaid)this.can_show_ad_container=true;else this.can_show_ad_container=false;this.current_bidder=video_ad.ad.bidder;this.current_bid=video_ad.ad.price;if(this.video_player.isolated==false&&this.ad_error==0&&this.application.proper_ops.dfp_ad_unit!="")this.send_DFP(video_ad.ad);else this.play_ad(video_ad.ad.vast_tag,video_ad.ad.vast_type);}}
Ads.prototype.play_ad=function(vast_tag,vast_type){this.application.log("trying to play an ad");this.application.ad_tag_url=vast_tag;this.application.ad_tag_type=vast_type;this.ad_display_container.initialize();if(!this.application.ads_called&&this.application.proper_ops.video_type!="outstream"&&this.application.proper_ops.multi_auction==false){this.application.ads_called=true;this.video_player.preload_content(this.application.bind(this.application,this.application.load_ads));}
else this.application.load_ads();}
Ads.prototype.send_DFP=function(bid){if(window.special_ops&&window.special_ops.post_id)var post_id=window.special_ops.post_id;else post_id=0;this.dfp_bid=this.round_bid(bid.price);var event=new CustomEvent('propervideo-dfp-set',{detail:bid.price,ads:this});win.dispatchEvent(event);if(this.dfp_price_floor>this.dfp_bid)this.dfp_bid=this.dfp_price_floor;this.application.log("Price sending to DFP: "+this.dfp_bid);var cust_params='post_id='+post_id+'&proper_video_bid='+this.dfp_bid;if(bid.bidder=='amazon_tam_instream'){cust_params+=utils.deepAccess(bid,'ad_details.qsParams')||'';}
var adTag='';adTag='https://securepubads.g.doubleclick.net/gampad/ads';adTag+='?env=vp';adTag+='&vpa=auto';adTag+='&vpmute=1';adTag+='&gdfp_req=1';adTag+='&unviewed_position_start=1';adTag+='&output=xml_vast3';adTag+='&sz='+encodeURIComponent('640x480|400x300|300x250');adTag+='&description_url='+encodeURIComponent(window.location.href);adTag+='&iu=/5376056/'+this.application.proper_ops.dfp_ad_unit;adTag+='&nofb=1';adTag+='&cust_params='+encodeURIComponent(cust_params);this.current_bidder="dfp";this.current_bid=this.dfp_bid;this.application.log("DFP: sending request");this.play_ad(adTag,"url");}
Ads.prototype.move_to_next_auction=function(reset){this.application.log("Auction called again");if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoPlayerOps")&&this.video_player.getVideoPlayerOps_called==false){this.video_player.overwrite_proper_ops(this.video_player.overwrite_data,this.video_player.overwrite_id);}
document.removeEventListener("proper-has-been-loaded",this.application.bind(this,this.move_to_next_auction));if(this.ad_play_count>=this.application.proper_ops.number_of_ads)return;if(this.ad_play_count<this.application.proper_ops.number_of_ads){if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoAd"))var video_ad=window.ProperMedia.ad_project.getVideoAd(this.application.slot_name);this.application.log(video_ad);this.ad_error=0;this.physical_time_reached=false;if(!video_ad||video_ad.ad.bidder=="dfp_floor"){this.ad_error=this.application.proper_ops.number_of_ads+1;if(this.application.proper_ops.video_type=="outstream"){this.video_player.can_play=false;this.video_player.destroy_player();return;}
else{this.schedule_another_auction();}}
else{if(reset)this.reset_ops();if(this.ads_manager)this.ads_manager.destroy();if(this.ads_loader)this.ads_loader.contentComplete();this.ad_muted=true;$("#"+this.application.div_name+" #propervideo-mute-div").html(pv_volume_mute_icon);this.video_player.player_time=this.video_player.content_player.currentTime;this.application.log('save video time:'+this.video_player.content_player.currentTime);var ad_container_div=$("#"+this.application.div_name+" #propervideo-ad_container").obj;ad_container_div.addEventListener('mouseenter',this.application.bind(this,this.show_ad_container));ad_container_div.addEventListener('mouseleave',this.application.bind(this,this.hide_ad_container));this.check_to_display_ad(video_ad);}}
else{this.application.inview.re_observe();}}
Ads.prototype.schedule_another_auction=function(){this.time_until_ad=15000;this.application.log("Another auction scheduled");setTimeout(function(){if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.runVideoAuction"))window.ProperMedia.ad_project.runVideoAuction(this.application.proper_ops.video_type);}.bind(this),13000);setTimeout(function(){this.application.log("Another auction completed");this.physical_time_reached=true;if((this.video_player.content_player.currentTime<=(this.video_player.content_player.duration-30))&&this.physical_time_reached&&(!this.video_player.video_paused)){this.move_to_next_auction(false);}}.bind(this),15000);}
Ads.prototype.reset_ops=function(){this.video_player.has_played=false,this.video_player.quartile_complete=false,this.video_player.half_complete=false,this.video_player.third_quartile_complete=false,this.video_player.finished=false;}
Ads.prototype.round_bid=function(price){if(price>=30.00)price="30.00";else if(price>=1.00)price=Math.ceil(price).toFixed(2);else if(price>0.10)price=(Math.ceil(price*4)/4).toFixed(2);else price="0.10";return price;}
var VideoPlayer=function(application){this.application=application;this.ads=null;this.player_destroyed=false;this.content_player=null;this.ad_container=null;this.this_container=null;this.can_play=true;this.getVideoPlayerOps_called=false;this.injected=false;this.small_player_can_open='false';this.image_url='';this.clickthrough_url='';this.quality=false;this.video_started=false;this.video_paused=false;this.player_position="main";this.time_watched=0;this.control_bar="hidden";this.isolated=false;this.video_type="";this.initial_play_clicked=0;this.proper_ops_set=false;this.overwrite_data=[];this.overwrite_id="";this.has_played=false,this.quartile_complete=false,this.half_complete=false,this.third_quartile_complete=false,this.finished=false;this.dash_player=null;};VideoPlayer.prototype.preload_content=function(content_loaded_action){this.application.log("Preloading content");if(this.is_mobile_platform()){this.preload_listener=content_loaded_action;this.content_player.addEventListener('loadedmetadata',content_loaded_action,false);if(!this.video_started)this.set_video("late_start");}
else content_loaded_action();this.application.inview.re_observe();};VideoPlayer.prototype.remove_preload_listener=function(){if(this.preload_listener){this.content_player.removeEventListener('loadedmetadata',this.preload_listener,false);this.preload_listener=null;}};VideoPlayer.prototype.play=function(){if(!this.content_player)return;if(this.can_play)this.content_player.play();};VideoPlayer.prototype.pause=function(){if(!this.content_player)return;this.content_player.pause();};VideoPlayer.prototype.is_mobile_platform=function(){return this.content_player.paused&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf('android')>-1);};VideoPlayer.prototype.resize=function(position,top,left,width,height,zIndex,marginTop){this.this_container.style.position=position;this.this_container.style.top=top;this.this_container.style.left=left;this.this_container.style.width=width;this.this_container.style.height=height;this.this_container.style.zIndex=zIndex;this.this_container.style.marginTop=marginTop;this.content_player.style.width=width;this.content_player.style.height=height;};VideoPlayer.prototype.register_video_ended_callback=function(callback){this.content_player.addEventListener('ended',callback,false);};VideoPlayer.prototype.remove_video_ended_callback=function(callback){this.content_player.removeEventListener('ended',callback,false);};VideoPlayer.prototype.create_player_html=function(ads){this.ads=ads;this.application.log("Adding player to page");var container=$("#"+this.application.div_name);this.application.log(this.application.proper_ops.video_type);if(this.application.proper_ops.video_type=="outstream")add_style(container.obj,"transform","scaleY(0)");container.addClass("propervideo-main_player_container");var insides=`
    <div id="propervideo-super_outer_container">
        <div id="outer_propervideo-back_image">
          <img id="propervideo-back_image" src="">
        </div>

        <div id="propervideo-main_container">
            <div id="propervideo-video_container">
                <div class="propervideo-cancel_float" id="propervideo-close_bottom_player">
                  ${pv_times_icon}
                </div>

                <video id="propervideo-content_video" playsinline muted>
                </video>

                <div id="propervideo-ad_container" style="">
                </div>

                <div id="propervideo-video_overlay_link" class="propervideo-video-launch-link propervideo-video-overlay-link font-m bold">
                    <div id="propervideo-play-pause-button-image">Image</div>
                    <div class="propervideo-white"><span id="propervideo-overlay-title">Title</span></div>
                </div>

                <div id="propervideo-controls">
                    <div class="top-progress-bar">
                        <input id="propervideo-progress_bar" type="range" value="0"></input>
                    </div>

                    <div class="propervideo-bottom-controls">
                        <div class="propervideo-left-group">
                            <button id="propervideo-play_button">${pv_play_icon}</button>
                            <span id="propervideo-time">
                                <span id="propervideo-time_progress_start">00:00</span>
                                <span id="propervideo-time_progress_finish">00:00</span>
                            </span>
                        </div>

                        <span id="propervideo-right-group">
                            <button id="propervideo-video_quality" class="propervideo-video-quality">${pv_cog_icon}</button>

                            <ul id="propervideo-quality-box">
                            </ul>

                            <button id="propervideo-replay_button" class="replay">${pv_restart_icon}</button>
                            <button id="propervideo-fullscreen_button" class="fullscreen">${pv_expand_icon}</button>
                        </span>
                    </div>
                </div>

                <span id="propervideo-volume-group">
                    <button id="propervideo-mute_button">${pv_volume_mute_icon}</button>
                    <input id="propervideo-volume_bar" type="range" min="0" max="1" step="0.1" value="1">
                </span>

                <div id="clickthrough_button">
                </div>
            </div>
        </div>
    </div>`
container.append(insides);this.this_container=$("#"+this.application.div_name+" #propervideo-video_container").obj;if(!this.application.scroll_item)this.application.inview.start_in_view();var injected=$("#"+this.application.div_name).attr("data-auto-injected");if(injected!=null&&(injected==true||injected=="true"))this.injected=true;else this.injected=false;if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.createVideoSlot")&&!this.injected)window.ProperMedia.ad_project.createVideoSlot(this.application.slot_name);};VideoPlayer.prototype.get_video_info=function(id,site){this.application.log("requesting video info from our server");$.ajax({method:"POST",url:global_ops.site_url+"/ajax/get_video.php",data:JSON.stringify({id:id,site:site}),timeout:10000,success:this.application.bind(this,this.get_video_success)});}
VideoPlayer.prototype.get_video_success=function(json){data=JSON.parse(json);if(data.success){this.application.log("Getting settings set up");if(this.application.width>500)this.quality=540;else this.quality=240;this.overwrite_proper_ops(data,this.application.div_name);this.application.video_id=this.application.site_name+"-id-"+data.video_id;if(data.hls_url!=""&&this.supportsHLS()){this.video_type="hls";this.application.video_url=data.hls_url;add_style($("#"+this.application.div_name+" #propervideo-video_quality").obj,"display","none");}
else if(data.dash_url!=""&&this.application.device_type=="desktop"){this.video_type="mpeg-dash";this.application.video_url=data.dash_url;add_style($("#"+this.application.div_name+" #propervideo-video_quality").obj,"display","none");this.content_player.setAttribute("preload","none");if(this.application.proper_ops.autoplay==1)this.content_player.setAttribute("autoplay","");}
else{this.video_type="mp4";this.application.video_url=global_ops.site_url+
"/ajax/main_video_url.php?id="+this.application.video_id+
"&quality="+this.quality+"&site="+this.application.site;}
this.application.log("video_type - "+this.video_type);$("#"+this.application.div_name+" #propervideo-back_image").obj.src=this.image_url;$("#"+this.application.div_name+" #propervideo-overlay-title").html(data.title);if(!data.qualities.includes(this.quality)){for(var x=0;x<data.qualities.length;x++){if(Number(data.qualities[x])<=Number(this.quality)){this.quality=data.qualities[x];break;}}
if(!data.qualities.includes(this.quality)){for(var x=data.qualities.length;x>=0;x--){if(Number(data.qualities[x])>=Number(this.quality)){this.quality=data.qualities[x];break;}}}}
var qualities=data.qualities;var rows=[];for(var x=0;x<qualities.length;x++){var row=document.createElement("li");row.setAttribute("id","quality_"+qualities[x]);var classes="propervideo-quality-item";if(qualities[x]==this.quality)classes+=" propervideo-selected";row.setAttribute("class",classes);row.innerHTML=qualities[x]+'p';row.onclick=function(quality){this.quality_switch(this.application.video_id,quality)
this.toggle_quality_box();}.bind(this,qualities[x]);rows.push(row)}
var quality_box=$("#"+this.application.div_name+" #propervideo-quality-box").obj;for(var x=0;x<rows.length;x++)quality_box.appendChild(rows[x]);this.application.log("About to start video, or wait for click to play");this.application.video_ended_callback=this.application.bind(this.application,this.application.on_content_ended);this.application.set_video_ended_callback_enabled(true);this.ads.initial_user_action();}
else{this.application.log(data.msg);this.application.proper_ops.number_of_ads=0;this.application.proper_ops.autoplay=0;this.switch_player("main");this.small_player_can_open="off";}}
VideoPlayer.prototype.overwrite_proper_ops=function(data,id){this.application.log("Overwriting Proper Ops");if(!(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.getVideoPlayerOps"))||this.getVideoPlayerOps_called==true){this.overwrite_data=data;this.overwrite_id=id;this.application.log(this.application.proper_ops.video_type);if(this.application.proper_ops.number_of_ads==0&&this.application.proper_ops.video_type!="outstream"){this.getVideoPlayerOps_called=true;this.proper_ops_set=true;}
else if(this.application.proper_ops.number_of_ads==0&&this.application.proper_ops.video_type=="outstream")this.application.proper_ops.number_of_ads=10;this.application.log("Returning early");return;}
this.getVideoPlayerOps_called=true;this.application.log("getVideoPlayerOps_called");if(data&&data!=[]){this.clickthrough_url=data.clickthrough_url;this.application.proper_ops.autoplay=data.autoplay?1:0;if(!this.application.site_name)this.application.site_name=data.publisher;$("#"+this.application.div_name+" #propervideo-overlay-title").html(data.title);if(data.thumbnail&&data.thumbnail!="")this.image_url="https://mediaproxy.propervideo.io/width/600/"+data.thumbnail;}
else{var title=$("#"+id).attr("data-video-title");var image=$("#"+id).attr("data-video-image");if(image&&image!="")this.image_url="https://mediaproxy.propervideo.io/width/600/"+image;$("#"+id+" #propervideo-overlay-title").html(title);}
this.application.proper_ops=window.ProperMedia.utils.mergeObject(this.application.proper_ops,window.ProperMedia.ad_project.getVideoPlayerOps(this.application.slot_name));this.application.log("ADS: "+this.application.proper_ops.number_of_ads);if(this.application.proper_ops.video_type=="outstream"){var backfill=$("#"+id).attr("data-backfill");if(backfill!=null&&backfill=="false")this.application.proper_ops.backfill=false;else if(backfill!=null&&backfill=="true")this.application.proper_ops.backfill=true;var number_of_ads=$("#"+id).attr("data-number-of-ads");if(number_of_ads!=null&&Number(number_of_ads)>=0)this.application.proper_ops.number_of_ads=Number(number_of_ads);}
var small_player=$("#"+id).attr("data-small-player");if(small_player!=null&&["desktop","desktop_ad","always","always_ad","never"].includes(small_player))this.application.proper_ops.small_player=small_player;if((this.application.proper_ops.small_player=="desktop"&&this.application.device_type=="desktop")||this.application.proper_ops.small_player=="always"){this.small_player_can_open="true";}
var no_ads_no_player=$("#"+id).attr("data-no-ads-no-player");if(no_ads_no_player!=null&&(no_ads_no_player==0||no_ads_no_player=="0"))this.application.no_ads_no_player=false;else if(no_ads_no_player!=null&&(no_ads_no_player==1||no_ads_no_player=="1"))this.application.no_ads_no_player=true;else if(this.application.proper_ops.backfill==true&&this.application.proper_ops.backfill_id!="")this.application.no_ads_no_player=true;if(!this.application.no_ads_no_player){add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"z-index","");add_style($("#"+this.application.div_name+" #propervideo-ad_container").obj,"background","");add_style($("#"+this.application.div_name).obj,"display","");}
var max_width=$("#"+id).attr("data-max-width");if(max_width!=null&&max_width=="100%"){this.application.log("Changing max-width to "+max_width);add_style($("#"+id+" #propervideo-video_container").obj,"max-width",max_width);add_style($("#"+id+" #propervideo-super_outer_container").obj,"max-width",max_width);add_style($("#"+id+" #propervideo-video_container").obj,"max-height",max_width);add_style($("#"+id+" #propervideo-super_outer_container").obj,"max-height",max_width);}
var autoplay=$("#"+id).attr("data-autoplay");if(autoplay!=null&&(autoplay==0||autoplay=="0"))this.application.proper_ops.autoplay=0;else if(autoplay!=null&&(autoplay==1||autoplay=="1"))this.application.proper_ops.autoplay=1;var clickthrough_url=$("#"+id).attr("data-clickthrough-url");if(clickthrough_url!=null&&clickthrough_url!="")this.clickthrough_url=clickthrough_url;if(this.clickthrough_url&&this.clickthrough_url!=""&&this.clickthrough_url!=win.location.href){var button_container=$("#"+id+" #clickthrough_button").obj;var button=document.createElement("a");button.setAttribute("id","clickthrough_url_button");button.setAttribute("href",this.clickthrough_url);button.setAttribute("target","_blank");if(this.application.site=="tvtropes")var button_text=document.createTextNode("Show Trope Page");else var button_text=document.createTextNode("Go To Video Page");button.appendChild(button_text);button_container.appendChild(button);}
this.proper_ops_set=true;}
VideoPlayer.prototype.assign_control_attributes=function(element,control_name){element.id="propervideo-"+control_name;element.className="propervideo-"+control_name+' '+control_name;}
VideoPlayer.prototype.quality_switch=function(video_id,quality){this.application.log("Switching quality to "+quality);if(this.video_started)this.pause();this.player_time=this.content_player.currentTime;this.quality=quality;var old_selected=$('#'+this.application.div_name+' .propervideo-selected');if(old_selected)old_selected.removeClass("propervideo-selected");var new_selected=$("#"+this.application.div_name+" #quality_"+quality);new_selected.addClass("propervideo-selected");var video_url=global_ops.site_url+
"/ajax/main_video_url.php?id="+
video_id+
"&quality="+
this.quality
+"&site="
+this.application.site;if(this.application.video_url==video_url)return;this.application.video_url=video_url;$('#'+this.application.div_name+' #propervideo-content_video source').remove();var source=document.createElement("source");source.src=this.application.video_url;source.type="video/mp4";this.content_player.appendChild(source);this.content_player.src=this.application.video_url;if(this.player_time>0){this.content_player.currentTime=this.player_time;}
if(this.content_player.paused&&this.video_started)this.play();}
VideoPlayer.prototype.player_options=function(){this.application.log("Setting up player options");$('#'+this.application.div_name+' #propervideo-play-pause-button-image').html(pv_overlay_play_button);$('#'+this.application.div_name+' #propervideo-play-pause-button-image').on('click',function(){this.application.log("background button clicked");this.initial_play_clicked=1;if(this.ads_active){if(this.ads.ad_playing)this.ads.pause();else this.ads.resume();}
else{if(this.content_player.paused){this.can_play=true;this.play();}
else{this.can_play=false;this.pause();}}}.bind(this));$('#'+this.application.div_name+' #propervideo-video_overlay_link').on("mouseover",function(){if(this.ads.ad_playing)this.ads.show_ad_container();else{add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","1");$("#"+this.application.div_name+" #propervideo-video_overlay_link").addClass("propervideo-expand");this.control_bar="displayed";if(this.application.device_type!="desktop"){setTimeout(function(){if(this.control_bar=="displayed"){add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","0");$("#"+this.application.div_name+" #propervideo-video_overlay_link").removeClass("propervideo-expand");this.control_bar="hidden";}}.bind(this),3000);}}}.bind(this));$('#'+this.application.div_name+' #propervideo-video_overlay_link').on("mouseout",function(){if(this.ads.ad_playing)this.ads.hide_ad_container();else{add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","0");$("#"+this.application.div_name+" #propervideo-video_overlay_link").removeClass("propervideo-expand");this.control_bar="hidden";}}.bind(this));$('#'+this.application.div_name+' #propervideo-controls').on("mouseover",function(){add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","1");}.bind(this));$('#'+this.application.div_name+' #propervideo-controls').on("mouseout",function(){add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","0");}.bind(this));$('#'+this.application.div_name+' #propervideo-content_video_'+this.application.div_name).on("mouseover",function(){add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","1");}.bind(this));$('#'+this.application.div_name+' #propervideo-content_video_'+this.application.div_name).on("mouseout",function(){add_style($('#'+this.application.div_name+' #propervideo-controls').obj,"opacity","0");}.bind(this));if(this.video_type=="mp4"){$('#'+this.application.div_name+' #propervideo-video_quality').on("click",function(){this.toggle_quality_box();}.bind(this));}
$("#"+this.application.div_name+" #propervideo-close_bottom_player").on("click",function(){if(this.player_position=="small"){this.switch_player("main");this.small_player_can_open="off";}}.bind(this));}
VideoPlayer.prototype.toggle_quality_box=function(){var quality_box=$('#'+this.application.div_name+' #propervideo-quality-box').obj;if(get_style(quality_box,"visibility")=="visible"){add_style($('#'+this.application.div_name+' #propervideo-quality-box').obj,"opacity","0");add_style($('#'+this.application.div_name+' #propervideo-quality-box').obj,"visibility","hidden");}
else{add_style($('#'+this.application.div_name+' #propervideo-quality-box').obj,"opacity","1");add_style($('#'+this.application.div_name+' #propervideo-quality-box').obj,"visibility","visible");}}
VideoPlayer.prototype.switch_player=function(player_location){if(this.player_position==player_location||!this.can_play||this.player_destroyed)return;this.application.log("Switch player to "+player_location);if(player_location=='main'){$("#"+this.application.div_name+" #propervideo-content_video").obj.style.height="";add_style($("#"+this.application.div_name+" #propervideo-close_bottom_player").obj,"z-index","0");add_style($("#"+this.application.div_name+" #propervideo-close_bottom_player").obj,"opacity","0");add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"right","-420px");add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"opacity","0");setTimeout(function(){$("#"+this.application.div_name+" #propervideo-video_container").removeClass("propervideo-bottom_player");setTimeout(function(){add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"right","");add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"opacity","1");this.player_position="main";this.application.width=$("#"+this.application.div_name+" #propervideo-content_video").obj.offsetWidth;this.application.height=$("#"+this.application.div_name+" #propervideo-content_video").obj.offsetHeight;this.ads.resize(this.application.width,this.application.height);this.application.inview.re_observe();}.bind(this),100);}.bind(this),400);}
else if(player_location=="small"){$("#"+this.application.div_name+" #propervideo-content_video").obj.style.height="100%";add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"opacity","0");add_style($("#"+this.application.div_name+" #propervideo-close_bottom_player").obj,"z-index","9999999999");add_style($("#"+this.application.div_name+" #propervideo-close_bottom_player").obj,"opacity","1");setTimeout(function(){add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"right","-420px");$("#"+this.application.div_name+" #propervideo-video_container").addClass("propervideo-bottom_player");add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"opacity","1");setTimeout(function(){if(this.application.proper_ops.video_type=="outstream"&&this.application.device_type=="mobile")add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"right","0px");else add_style($("#"+this.application.div_name+" #propervideo-video_container").obj,"right","30px");this.player_position="small";this.application.width=$("#"+this.application.div_name+" #propervideo-content_video").obj.offsetWidth;this.application.height=$("#"+this.application.div_name+" #propervideo-content_video").obj.offsetHeight;this.ads.resize(this.application.width,this.application.height);this.application.inview.re_observe();}.bind(this),300);}.bind(this),200);}}
VideoPlayer.prototype.control_bar_setup=function(){var play_button=$("#"+this.application.div_name+" #propervideo-play_button").obj;var progress_bar=$("#"+this.application.div_name+" #propervideo-progress_bar").obj;var mute_button=$("#"+this.application.div_name+" #propervideo-mute_button").obj;var volume_bar=$("#"+this.application.div_name+" #propervideo-volume_bar").obj;var fullscreen_button=$("#"+this.application.div_name+" #propervideo-fullscreen_button").obj;var replay_button=$("#"+this.application.div_name+" #propervideo-replay_button").obj;if(this.application.proper_ops.video_type=="outstream")return;mute_button.addEventListener('click',function(){this.application.log("mute button clicked");if(this.content_player.muted==true){this.content_player.muted=false;this.muted=false;$("#"+this.application.div_name+" #propervideo-mute_button").html(pv_volume_up_icon);$("#"+this.application.div_name+" #propervideo-volume_bar").val(this.content_player.volume);if(this.application.device_type=="mobile")this.content_player.volume=1;}else{this.content_player.muted=true;this.muted=true;$("#"+this.application.div_name+" #propervideo-mute_button").html(pv_volume_mute_icon);$("#"+this.application.div_name+" #propervideo-volume_bar").val(0);}}.bind(this),false);replay_button.addEventListener('click',function(){this.application.log("replay button clicked");this.content_player.currentTime=0;this.time_watched=0;}.bind(this),false);progress_bar.addEventListener('change',this.progress_bar_update.bind(this),false);volume_bar.addEventListener('change',function(){this.content_player.volume=$("#"+this.application.div_name+" #propervideo-volume_bar").val();if($("#"+this.application.div_name+" #propervideo-volume_bar").val()>0){this.content_player.muted=false;this.muted=false;$("#"+this.application.div_name+" #propervideo-mute_button").html(pv_volume_up_icon);}
else{$("#"+this.application.div_name+" #propervideo-mute_button").html(pv_volume_mute_icon);this.content_player.muted=true;this.muted=true;}
this.volume=this.content_player.volume;}.bind(this),false);play_button.addEventListener('click',function(){this.application.log("play button clicked");this.initial_play_clicked=1;if(this.ads_active){if(this.ads.ad_playing)this.ads.pause();else this.ads.resume();}
else{if(this.content_player.paused){this.can_play=true;this.play();}
else{this.can_play=false;this.pause();}}}.bind(this),false);fullscreen_button.addEventListener('click',this.application.bind(this.application,this.application.on_fullscreen_click),false);volume_bar.value=0;progress_bar.value=0;}
VideoPlayer.prototype.progress_bar_update=function(){if(!$("#"+this.application.div_name+" #propervideo-progress_bar").obj)return;var newTime=this.content_player.duration*($("#"+this.application.div_name+" #propervideo-progress_bar").val()/100);this.content_player.currentTime=newTime;}
VideoPlayer.prototype.player_tracking=function(){if(this.application.proper_ops.video_type=="outstream")return;this.application.log("Start Player tracking");this.content_player.addEventListener('play',function(){if(this.application.proper_ops.autoplay==0&&this.initial_play_clicked==0)return;if(!this.video_started){this.video_started=true;this.application.log("video_started is now true");if(!this.ads.ima_script_called&&this.application.proper_ops.number_of_ads>0)this.ads.load_ima_script();var event=new CustomEvent('propervideo-video-started');win.dispatchEvent(event);}
$("#"+this.application.div_name+" #propervideo-play_button").html(pv_pause_icon);$('#'+this.application.div_name+' #propervideo-play-pause-button-image').html(pv_overlay_pause_button);this.application.inview.re_observe();}.bind(this),false);this.content_player.addEventListener('pause',function(){$("#"+this.application.div_name+" #propervideo-play_button").html(pv_play_icon);$('#'+this.application.div_name+' #propervideo-play-pause-button-image').html(pv_overlay_play_button);this.application.inview.re_observe();}.bind(this),false);this.content_player.addEventListener('timeupdate',this.progress_bar_time_update.bind(this),false);this.content_player.onended=function(){if(this.ads.ad_playing)return;if(!this.finished){this.finished=true;}
this.application.log("Resetting video to beginning");this.content_player.currentTime=0;this.player_time=0;this.time_watched=0;this.ads.move_to_next_auction(true);}.bind(this);}
VideoPlayer.prototype.progress_bar_time_update=function(){var value=(100/this.content_player.duration)*this.content_player.currentTime;if((!this.content_player.seeking)&&(!this.video_paused)&&(!this.ads.ad_playing)&&this.video_started){var temp_time=Math.floor(this.content_player.currentTime)*1000;if(temp_time>=(this.time_watched+1000)){this.ads.time_until_ad-=1000;this.time_watched+=1000;}}
$("#"+this.application.div_name+" #propervideo-progress_bar").val(value)
$("#"+this.application.div_name+" #propervideo-progress_bar").obj.style['background-size']=Math.round(value)+"% 100%"
$("#"+this.application.div_name+" #propervideo-time_progress_start").html(this.convert_video_time(Math.floor(this.content_player.currentTime)));if((!isNaN(this.content_player.duration))){$("#"+this.application.div_name+" #propervideo-time_progress_finish").html("/&nbsp;"+this.convert_video_time(Math.floor(this.content_player.duration)));}
if(this.ads.ad_playing)return;if(this.ads.time_until_ad<=0&&(this.content_player.currentTime<=(this.content_player.duration-30))&&this.ads.physical_time_reached&&(!this.video_paused)){this.ads.move_to_next_auction(false);}
if(!this.has_played&&this.content_player.currentTime>=2){this.has_played=true;}
if(!this.quartile_complete&&this.content_player.currentTime>this.content_player.duration/4){this.quartile_complete=true;}
if(!this.half_complete&&this.content_player.currentTime>this.content_player.duration/2){this.half_complete=true;}
if(!this.third_quartile_complete&&this.content_player.currentTime>(this.content_player.duration/4)*3){this.third_quartile_complete=true;}}
VideoPlayer.prototype.convert_video_time=function(time){var return_time,hours,minutes,seconds;seconds=time;minutes=Math.floor(time/60);seconds-=(minutes*60);if(minutes>60){hours=Math.floor(minutes/60);minutes-=(hours*60);}
if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
return_time=minutes+":"+seconds;if(hours&&hours>0){return_time=hours+":"+time;}
return return_time;}
VideoPlayer.prototype.set_video=function(type){this.application.log("Setting video up");if(this.content_player){if(this.video_type=="mp4"){var sourceMP4=document.createElement("source");sourceMP4.src=this.application.video_url;sourceMP4.type="video/mp4";this.content_player.appendChild(sourceMP4);if(!this.video_started)this.content_player.load();}
else{if(this.video_type=="hls"){var source_hls=document.createElement("source");source_hls.type="application/x-mpegurl";source_hls.setAttribute("src",this.application.video_url);source_hls.setAttribute("id","source_hls");this.content_player.setAttribute("data-dashjs-player","");this.content_player.appendChild(source_hls,this.content_player);}
else if(this.video_type=="mpeg-dash"){var source_dash=document.createElement("div");source_dash.type="application/dash+xml";source_dash.setAttribute("data-src",this.application.video_url);source_dash.setAttribute("id","source_dash");this.content_player.parentNode.insertBefore(source_dash,this.content_player);this.ads.loadScript("https://player.propervideo.io/new_src/libraries/dash.min.js").then(data=>{this.application.log("Dash library loaded");this.dash_player=dashjs.MediaPlayer().create();this.dash_player.updateSettings({'streaming':{'abr':{'minBitrate':{'video':350},'maxBitrate':{'video':5000},'limitBitrateByPortal':true},'stableBufferTime':5,'bufferTimeAtTopQuality':5,'bufferTimeAtTopQualityLongForm':5}});var dash_autoplay=this.application.proper_ops.autopaly==1?true:false;this.dash_player.initialize(this.content_player,this.application.video_url,dash_autoplay);}).catch(()=>{this.application.log("Dash library NOT loaded");});}}
if(this.application.proper_ops.video_type=="outstream")return;if(!this.application.set_video_called){this.application.set_video_called=true;this.control_bar_setup();this.player_options();this.player_tracking();}
if(!this.video_started&&type!="late_start"&&this.application.proper_ops.autoplay==1)this.play();}}
VideoPlayer.prototype.destroy_player=function(){var index=displays_called.indexOf(this.application.div_name);if(index>-1)displays_called.splice(index,1);this.player_destroyed=true;this.switch_player("main");this.application.log("DESTROYING PLAYER");if(this.application.proper_ops.video_type=="outstream"){add_style($("#"+this.application.div_name).obj,"transform","scaleY(0)");setTimeout(function(){$("#"+this.application.div_name).html("");var event_name="propervideo-destroying-player";if(this.ads.ad_play_count>0)event_name+="-after-ad";var event=new CustomEvent(event_name);window.dispatchEvent(event);if(utils.deepAccess&&utils.deepAccess(window.ProperMedia,"ad_project.destroyVideoPlayer"))window.ProperMedia.ad_project.destroyVideoPlayer(this.application.slot_name);if(this.application.proper_ops.backfill==true)this.ads.proper_backfill(true);else if(this.application.proper_ops.multi_auction==true)this.application.multi_auction_callback(window.ProperMedia.ad_project.revContGetWinningBids(["outstream","display"],false));}.bind(this),300);return;}else{add_style($("#"+this.application.div_name).obj,"display","none");$("#"+this.application.div_name).html("");var event_name="propervideo-destroying-player";if(this.ads.ad_play_count>0)event_name+="-after-ad";var event=new CustomEvent(event_name);win.dispatchEvent(event);}
if(this.ads_manager)this.ads_manager.destroy();if(this.application.proper_ops.backfill==true&&this.ads.ad_play_count==0)this.ads.proper_backfill(true);else{this.application.log("Firing backfill ready event");var event=new CustomEvent('propervideo-video-backfill-ready');win.dispatchEvent(event);}}
VideoPlayer.prototype.supportsHLS=function(){return false;var video=document.createElement('video');return Boolean(video.canPlayType('application/vnd.apple.mpegURL')||video.canPlayType('audio/mpegurl'))}
var Inview=function(application){this.application=application;this.video_player=null;this.ads=null;this.application.log("Creating Inview object");if('IntersectionObserver'in window){var interactSettings={rootMargin:'0px',threshold:0.80};this.application.observer=new IntersectionObserver(this.application.bind(this,this.on_intersection),interactSettings);}
else if(!this.application.observer){window.addEventListener('scroll',this.application.bind(this,this.throttle(this.classic_lazy_load),16));window.addEventListener('resize',this.application.bind(this,this.throttle(this.classic_lazy_load),16));}
$(document).ready(function(){this.application.log("Document is ready");document.body.addEventListener('keydown',function(e){if(e.key=="Escape"){e.preventDefault();if(this.application.fullscreen){var cancel_fullscreen=document.exitFullscreen||document.exitFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;if(cancel_fullscreen&&document.fullscreenElement)cancel_fullscreen.call(document);else this.application.on_fullscreen_change();}}}.bind(this));this.start_in_view();}.bind(this));};Inview.prototype.in_view_logic=function(in_view){var status=(in_view==true)?"can_see_main":"main_not_in_sight";if(!this.application.video_player){this.application.log("No existing Video Player object");return;}
if(!this.application.video_player.proper_ops_set)return;if(this.application.video_player.content_player&&this.application.ads.ad_playing&&this.application.ads.ad_paused)var player_status="main_not_in_sight";else if(this.application.video_player.content_player&&!this.application.ads.ad_playing&&this.application.video_player.video_started&&this.application.video_player.content_player.paused)var player_status="main_not_in_sight";else if(this.application.video_player.content_player)var player_status='can_see_main';else return;if((this.application.video_player.video_paused&&this.application.video_player.player_position!="small")||this.application.fullscreen)return;if(this.application.video_player.small_player_can_open=="true"){if(this.application.video_player.content_player.paused&&this.application.video_player.video_started&&!this.application.ads.ad_playing)this.application.video_player.play();if(status=='main_not_in_sight')this.application.video_player.switch_player("small");else if(status=='can_see_main')this.application.video_player.switch_player("main");}
else if(player_status!=status&&(this.application.video_player.video_started||this.application.ads.ad_playing)){if(status=="main_not_in_sight"){if(this.application.ads.ad_playing&&!this.application.ads.ad_paused)this.application.ads.pause();else if((!this.application.video_player.content_player.paused)&&this.application.video_player.video_started)this.application.video_player.pause();}
else if(status=="can_see_main"){if(this.application.ads.ad_playing&&this.application.ads.ad_paused)this.application.ads.resume();else if(this.application.video_player.content_player.paused&&this.application.video_player.video_started&&!this.application.ads.ad_playing)this.application.video_player.play();}}}
Inview.prototype.start_in_view=function(){if(this.application.div_name=="")return;this.application.scroll_item=$("#"+this.application.div_name+' #propervideo-main_container').obj;if((!this.application.scroll_item)||this.application.scroll_started)return;this.application.scroll_started=true;this.application.log("Starting in view checks");var intersection_observer=false;if('IntersectionObserver'in window)intersection_observer=true;if(intersection_observer)this.application.observer.observe(this.application.scroll_item);else this.classic_lazy_load();}
Inview.prototype.on_intersection=function(items){items.forEach(function(item){if(item.isIntersecting)this.in_view_logic(true);else this.in_view_logic(false);}.bind(this));}
Inview.prototype.classic_lazy_load=function(){this.application.log("Classic method");if(this.in_viewport_check(this.application.scroll_item))this.in_view_logic(true);else this.in_view_logic(false);}
Inview.prototype.in_viewport_check=function(el){var top=el.offsetTop;var left=el.offsetLeft;var width=el.offsetWidth;var height=el.offsetHeight;if(document.documentElement.clientWidth<600)var load_height=(document.documentElement.clientHeight*1.5);else var load_height=100;while(el.offsetParent){el=el.offsetParent;top+=el.offsetTop;left+=el.offsetLeft;}
return(top>=(window.pageYOffset-load_height)&&(top+height)<=((window.pageYOffset+load_height)+window.innerHeight));}
Inview.prototype.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:Date.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null;};return function(){var now=Date.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null;}
previous=now;result=func.apply(context,args);if(!timeout)context=args=null;}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};}
Inview.prototype.re_observe=function(){if(this.application.scroll_item&&this.application.observer){this.application.observer.unobserve(this.application.scroll_item);this.application.observer.observe(this.application.scroll_item);}
else if(this.application.scroll_item){this.classic_lazy_load();}}
var application=new Application();function init(){propervideotag.initiated=true;propervideotag.push=function(cmd){cmd.call();}
for(i=0;i<propervideotag.length;i++)propervideotag[i].call();}
function propervideo_display(div_id,slot_id,site,site_url){if(typeof propertag!="undefined"&&typeof ProperMedia!="undefined"&&typeof ProperMedia.ad_project!="undefined"){propertag.cmd.push(function(){actual_propervideo_display(div_id,slot_id,site,site_url);});}
else actual_propervideo_display(div_id,slot_id,site,site_url);}
function actual_propervideo_display(div_id,slot_id,site,site_url){if(!site||site==""){site=slot_id;slot_id=div_id;}
if(displays_called.includes(div_id))return;displays_called.push(div_id);var application=new Application();applications.push(application);application.inview=new Inview(application);update_get_vars(application);if(site_url&&site_url=="outstream_restart"){application.scroll_started=false;application.inview.start_in_view();}
else if(site_url&&site_url!="")global_ops.site_url=site_url;application.start_everything(div_id,slot_id,site);application.inview.re_observe();}
function add_style(item,property,value){item.style[property]=value;}
function get_style(item,property){return item.style[property];}
function update_get_vars(application){var get_vars=['proper_logging'];for(var i=0;i<get_vars.length;i++){var k=get_vars[i];if(get_var(k))application.proper_ops[k]=get_var(k);}}
function proper_log(){for(var x=0;x<applications.length;x++){for(var y in applications[x].log_lines)console.log(applications[x].log_lines[y]);}}
function get_var(sParam){var s_page_url=window.location.search.substring(1),s_url_variables=s_page_url.split('&'),s_parameter_name,i;for(i=0;i<s_url_variables.length;i++){s_parameter_name=s_url_variables[i].split('=');if(s_parameter_name[0]===sParam){return s_parameter_name[1]===undefined?true:decodeURIComponent(s_parameter_name[1]);}}}
function reset_proper_ops(){return{ad_failure_limit:5,autoplay:1,backfill:false,backfill_id:"",dfp_ad_unit:"",number_of_ads:0,small_player:"desktop_ad",small_player_bottom:100,vast_timeout:5000,video_id:"salon-playlist-featured",video_type:"",proper_logging:0,multi_auction:false};}
return{propervideo_display:propervideo_display,toggle_quality_box:application.toggle_quality_box,quality_switch:application.quality_switch,propervideo_log:proper_log,init:init,global_ops:global_ops,applications:applications};})(window,document);var propervideo_log=ProperMediaVideo.ad_project.propervideo_log;var propervideo_display=ProperMediaVideo.ad_project.propervideo_display;ProperMediaVideo.ad_project.init();}